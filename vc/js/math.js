var defaultDecimals=18,pi=Math.PI,eulerGamma=.5772156649015329,constants={decimals:50,precisionScale:10n**50n,e:271828182845904523536028747135266249775724709369995n,eulerGamma:57721566490153286060651209008240243104215933593992n,ln10:230258509299404568401799145468436420760110148862877n,pi:314159265358979323846264338327950288419716939937510n};function getConstant(r){return constants[r]*precisionScale/constants.precisionScale}bernoulli2nN=[1n,1n,-1n,1n,-1n,5n,-691n,7n,-3617n,43867n,-174611n,854513n,-236364091n,8553103n,-23749461029n,8615841276005n,-7709321041217n,2577687858367n,-26315271553053477373n,2929993913841559n,-261082718496449122051n,1520097643918070802691n,-27833269579301024235023n,596451111593912163277961n,-5609403368997817686249127547n,495057205241079648212477525n,-801165718135489957347924991853n,29149963634884862421418123812691n,-2479392929313226753685415739663229n,84483613348880041862046775994036021n,-1215233140483755572040304994079820246041491n,12300585434086858541953039857403386151n,-106783830147866529886385444979142647942017n,1472600022126335654051619428551932342241899101n,-78773130858718728141909149208474606244347001n,1505381347333367003803076567377857208511438160235n,-5827954961669944110438277244641067365282488301844260429n,34152417289221168014330073731472635186688307783087n,-24655088825935372707687196040585199904365267828865801n,414846365575400828295179035549542073492199375372400483487n,-4603784299479457646935574969019046849794257872751288919656867n,1677014149185145836823154509786269900207736027570253414881613n,-2024576195935290360231131160111731009989917391198090877281083932477n,660714619417678653573847847426261496277830686653388931761996983n,-1311426488674017507995511424019311843345750275572028644296919890574047n,1179057279021082799884123351249215083775254949669647116231545215727922535n,-1295585948207537527989427828538576749659341483719435143023316326829946247n,1220813806579744469607301679413201203958508415202696621436215105284649447n,-211600449597266513097597728109824233673043954389060234150638733420050668349987259n,67908260672905495624051117546403605607342195728504487509073961249992947058239n,-94598037819122125295227433069493721872702841533066936133385696204311395415197247711n],bernoulli2nD=[1n,6n,30n,42n,30n,66n,2730n,6n,510n,798n,330n,138n,2730n,6n,870n,14322n,510n,6n,1919190n,6n,13530n,1806n,690n,282n,46410n,66n,1590n,798n,870n,354n,56786730n,6n,510n,64722n,30n,4686n,140100870n,6n,30n,3318n,230010n,498n,3404310n,6n,61410n,272118n,1410n,6n,4501770n,6n,33330n];var factorialCache=[1,1,2,6,24,120,720,5040,40320,362880,3628800];function complex(r,e=0){return{re:r,im:e=0===e&&isArbitrary(r)?0n:e}}var C=complex;function isComplex(r){return"object"==typeof r&&"re"in r}var precisionScale,arb1,arb2,onePi,twoPi,halfPi,ln10,decimals=[];function setPrecisionScale(r){"reset"===r?decimals.shift():decimals.unshift(r),precisionScale=10n**BigInt(decimals[0]),arb1=arbitrary(1),arb2=2n*arb1,onePi=getConstant("pi"),twoPi=2n*onePi,halfPi=onePi/2n,ln10=getConstant("ln10")}function resetPrecisionScale(){setPrecisionScale("reset")}function arbitrary(r){var e,i,a;return isComplex(r)?{re:arbitrary(r.re),im:arbitrary(r.im)}:isArbitrary(r)?Number(r)/10**decimals[0]:(i=(e=(a=r.toExponential().split("e"))[0].replace(".","")).length-("-"===e[0]?2:1),(a=+a[1]+decimals[0]-i)<0?BigInt(Math.round(r*10**decimals[0])):BigInt(e+"0".repeat(a)))}setPrecisionScale(defaultDecimals);var A=arbitrary;function isArbitrary(r){return"bigint"==typeof r||"bigint"==typeof r.re}function isZero(r){return isComplex(r)?0===r.re&&0===r.im:0===r}function isUnity(r){return isComplex(r)?1===r.re&&0===r.im:1===r}function isReal(r){return!isComplex(r)||0===r.im}function isInteger(r){return isComplex(r)?Number.isInteger(r.re)&&0===r.im:Number.isInteger(r)}function isPositiveInteger(r){return isComplex(r)?Number.isInteger(r.re)&&0<r.re&&0===r.im:Number.isInteger(r)&&0<r}function isPositiveIntegerOrZero(r){return isComplex(r)?Number.isInteger(r.re)&&0<=r.re&&0===r.im:Number.isInteger(r)&&0<=r}function isNegativeInteger(r){return isComplex(r)?Number.isInteger(r.re)&&r.re<0&&0===r.im:Number.isInteger(r)&&r<0}function isNegativeIntegerOrZero(r){return isComplex(r)?Number.isInteger(r.re)&&r.re<=0&&0===r.im:Number.isInteger(r)&&r<=0}function isEqualTo(r,e){return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),r.re===e.re&&r.im===e.im):r===e}function re(r){return isComplex(r)?r.re:r}var real=re;function im(r){return isComplex(r)?r.im:0}var imag=im;function abs(r){return isComplex(r)?isArbitrary(r)?0n===r.im?abs(r.re):0n===r.re?abs(r.im):abs(r.re)<abs(r.im)?mul(abs(r.im),sqrt(arb1+div(div(mul(r.re,r.re),r.im),r.im))):mul(abs(r.re),sqrt(arb1+div(div(mul(r.im,r.im),r.re),r.re))):0===r.im?Math.abs(r.re):0===r.re?Math.abs(r.im):Math.abs(r.re)<Math.abs(r.im)?Math.abs(r.im)*Math.sqrt(1+(r.re/r.im)**2):Math.abs(r.re)*Math.sqrt(1+(r.im/r.re)**2):isArbitrary(r)?r<0n?-r:r:Math.abs(r)}function arg(r){return isArbitrary(r)?ln(r).im:isComplex(r)?Math.atan2(r.im+0,r.re+0):Math.atan2(0,r+0)}function add(r,e){if(2<arguments.length){for(var i=add(r,e),a=2;a<arguments.length;a++)i=add(i,arguments[a]);return i}return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),{re:r.re+e.re,im:r.im+e.im}):r+e}function sub(r,e){return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),{re:r.re-e.re,im:r.im-e.im}):r-e}function mul(r,e){if(2<arguments.length){for(var i=mul(r,e),a=2;a<arguments.length;a++)i=mul(i,arguments[a]);return i}return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),isArbitrary(r)?{re:(r.re*e.re-r.im*e.im)/precisionScale,im:(r.im*e.re+r.re*e.im)/precisionScale}:{re:r.re*e.re-r.im*e.im,im:r.im*e.re+r.re*e.im}):isArbitrary(r)?r*e/precisionScale:r*e}function neg(r){return isComplex(r)?{re:-r.re,im:-r.im}:-r}function div(r,e){if(isComplex(r)||isComplex(e)){if(isComplex(r)||(r=complex(r)),0===(e=isComplex(e)?e:complex(e)).re&&0===e.im||0n===e.re&&0n===e.im)throw Error("Division by zero");var i,a,t,n;return isArbitrary(r)?(i=r.re*e.re+r.im*e.im,a=r.im*e.re-r.re*e.im,t=e.re*e.re+e.im*e.im,{re:precisionScale*i/t,im:precisionScale*a/t}):Math.abs(e.re)<Math.abs(e.im)?(n=e.re/e.im,{re:(r.re*n+r.im)/(e.re*n+e.im),im:(r.im*n-r.re)/(e.re*n+e.im)}):(n=e.im/e.re,{re:(r.re+r.im*n)/(e.re+e.im*n),im:(r.im-r.re*n)/(e.re+e.im*n)})}if(0===e||0n===e)throw Error("Division by zero");return isArbitrary(r)?precisionScale*r/e:r/e}function inv(r){return isArbitrary(r)?div(arb1,r):div(1,r)}function pow(r,e){if(isArbitrary(r)||isArbitrary(e))return isArbitrary(r)||(r=arbitrary(r)),exp(mul(e=isArbitrary(e)?e:arbitrary(e),ln(r)));if(isComplex(r)||isComplex(e)){if(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),0===r.re&&0===r.im&&0<e.re)return complex(0);if(0===r.re&&0===r.im&&0===e.re&&0===e.im)return complex(1);if(0===r.re&&0===r.im&&e.re<0)throw Error("Power singularity");return exp(mul(e,log(r)))}if(0===r&&e<0)throw Error("Power singularity");return r<0&&!Number.isInteger(e)?pow(complex(r),e):r**e}function root(r,e){return pow(r,div(1,e))}function surd(r,e){if(isComplex(r)||isComplex(e))throw Error("Surd requires real inputs");if(!isInteger(e))throw Error("Second parameter of surd must be integer");var i;if(1&e)return(i=Math.sign(r))*root(i*r,e);if(r<0)throw Error("First parameter of surd must be positive for even integers");return root(r,e)}function sqrt(r){var e,i;if(isComplex(r))return isArbitrary(r)?0n===r.im?r.re<0n?{re:0n,im:sqrt(-r.re)}:{re:sqrt(r.re),im:0n}:(e=abs(r),i=r.im<0n?-1n:1n,{re:sqrt(div(e+r.re,arb2)),im:i*sqrt(div(e-r.re,arb2))}):0===r.im?r.re<0?{re:0,im:Math.sqrt(-r.re)}:{re:Math.sqrt(r.re),im:0}:exp(mul(.5,log(r)));if(isArbitrary(r)){if(0n===r)return 0n;if(r<0n)throw Error("Cannot evaluate real square root of "+r);for(var a,t,n=r;n!==a;)t=(a=n)+div(r,a),n=div(t,arb2);return a}return r<0?{re:0,im:Math.sqrt(-r)}:Math.sqrt(r)}function complexAverage(r,e,i=1e-5){return div(add(r(add(e,i)),r(sub(e,i))),2)}function complexFromString(r,e=!1){var i,a="";return"+"!==r[0]&&"-"!==r[0]||(a=r[0],r=r.slice(1)),""!==(a=r.includes("+")||r.includes("-")?r.includes("+")?(i=a+r.slice(0,r.indexOf("+")),r.slice(r.indexOf("+")+1,r.length-1)):(i=a+r.slice(0,r.indexOf("-")),r.slice(r.indexOf("-"),r.length-1)):r.includes("i")?(i="0",a+r.slice(0,r.length-1)):(i=a+r,"0"))&&"-"!==a||(a+="1"),e?`{ re: ${i}, im: ${a} }`:{re:+i,im:+a}}function output(){for(var r=0;r<arguments.length;r++)console.log(arguments[r])}function besselJ(r,e){return isComplex(r)||isComplex(e)?isNegativeInteger(r)?mul(pow(-1,r),besselJ(neg(r),e)):mul(div(pow(div(e,2),r),gamma(add(r,1))),hypergeometric0F1(add(r,1),mul(-.25,pow(e,2)))):isNegativeInteger(r)?(-1)**r*besselJ(-r,e):!Number.isInteger(r)&&e<0?besselJ(r,complex(e)):(e/2)**r*hypergeometric0F1(r+1,-.25*e**2)/gamma(r+1)}function besselJZero(e,r,i=!1){if(isComplex(e)||isComplex(r))throw Error("Complex arguments not supported in Bessel zero");if(!isPositiveInteger(r))throw Error("Unsupported index for Bessel zero");var a=pi/4;if(i){if(0===e&&1===r)return 0;var i=(r+Math.abs(e)/2-.75)*pi,t=i-(4*e**2+3)/(8*i);if(e<0)throw Error("Negative order for Bessel derivative zero not supported");return findRoot(r=>diff(r=>besselJ(e,r),r),[t-a<0?0:t-a,t+a])}return t=(i=(r+Math.abs(e)/2-.25)*pi)-(4*e**2-1)/(8*i),e<0&&(t+=fractionalPart(e)*pi),findRoot(r=>besselJ(e,r),[1===r?1e-10:t-a,t+a])}function besselY(r,e){return isComplex(r)||isComplex(e)?isZero(e)&&-.5===fractionalPart((r=isComplex(r)?r:complex(r)).re)&&0===r.im?complex(0):isInteger(r)?div(add(diff(r=>besselJ(r,e),r),mul(pow(-1,r),diff(r=>besselJ(r,e),neg(r)))),pi):div(sub(mul(besselJ(r,e),cos(mul(r,pi))),besselJ(neg(r),e)),sin(mul(r,pi))):e<0?besselY(r,complex(e)):0===e&&-.5===fractionalPart(r)?0:Number.isInteger(r)?(diff(r=>besselJ(r,e),r)+(-1)**r*diff(r=>besselJ(r,e),-r))/pi:(besselJ(r,e)*cos(r*pi)-besselJ(-r,e))/sin(r*pi)}function besselYZero(e,r,i=!1){if(isComplex(e)||isComplex(r))throw Error("Complex arguments not supported in Bessel zero");if(!isPositiveInteger(r))throw Error("Unsupported index for Bessel zero");var a=pi/4;if(i){var i=(r+Math.abs(e)/2-.25)*pi,t=i-(4*e**2+3)/(8*i);if(e<0)throw Error("Negative order for Bessel derivative zero not supported");return findRoot(r=>diff(r=>besselY(e,r),r),[t-a,t+a])}return t=(i=(r+Math.abs(e)/2-.75)*pi)-(4*e**2-1)/(8*i),e<0&&(-.5<fractionalPart(e)?t+=fractionalPart(e)*pi:t+=(1+fractionalPart(e))*pi),findRoot(r=>besselY(e,r),[1===r&&-.5<fractionalPart(e)?1e-10:t-a,t+a])}function besselI(r,e){return isComplex(r)||isComplex(e)?isNegativeInteger(r)?besselI(neg(r),e):mul(div(pow(div(e,2),r),gamma(add(r,1))),hypergeometric0F1(add(r,1),mul(.25,pow(e,2)))):isNegativeInteger(r)?besselI(-r,e):!Number.isInteger(r)&&e<0?besselI(r,complex(e)):(e/2)**r*hypergeometric0F1(r+1,.25*e**2)/gamma(r+1)}function besselK(r,e){var i;return isComplex(r)||isComplex(e)?10<abs(e)?(i=mul(sqrt(div(pi/2,e)),exp(neg(e))),mul(i,hypergeometric2F0(add(r,.5),sub(.5,r),div(-.5,e)))):isInteger(r)?mul(pow(-1,add(r,1)),.5,add(diff(r=>besselI(r,e),r),diff(r=>besselI(r,e),neg(r)))):(i=div(pi/2,sin(mul(r,pi))),mul(i,sub(besselI(neg(r),e),besselI(r,e)))):10<e?sqrt(pi/2/e)*exp(-e)*hypergeometric2F0(r+.5,.5-r,-.5/e):e<0?besselK(r,complex(e)):Number.isInteger(r)?(-1)**(r+1)/2*(diff(r=>besselI(r,e),r)+diff(r=>besselI(r,e),-r)):pi/2*(besselI(-r,e)-besselI(r,e))/sin(r*pi)}function hankel1(r,e,i=1e-10){if(0<e.im&&11<abs(e)){for(var a=add(e,mul(r,-pi/2),-pi/4),t=complex(1),n=complex(0,1),o=complex(1),m=1;Math.abs(o.re)>i||Math.abs(o.im)>i;)t=add(t,o=mul(o,n,sub(mul(4,r,r),(2*m-1)**2),1/m,1/8,inv(e))),m++;return mul(div(Math.sqrt(2/pi),sqrt(e)),exp(mul(n,a)),t)}return isInteger(r)?add(besselJ(r,e),mul(complex(0,1),besselY(r,e))):(t=sub(mul(besselJ(r,e),exp(mul(r,complex(0,-pi)))),besselJ(neg(r),e)),div(mul(complex(0,1),t),sin(mul(r,pi))))}function hankel2(r,e,i=1e-10){if(e.im<0&&11<abs(e)){for(var a=add(e,mul(r,-pi/2),-pi/4),t=complex(1),n=complex(0,-1),o=complex(1),m=1;Math.abs(o.re)>i||Math.abs(o.im)>i;)t=add(t,o=mul(o,n,sub(mul(4,r,r),(2*m-1)**2),1/m,1/8,inv(e))),m++;return mul(div(Math.sqrt(2/pi),sqrt(e)),exp(mul(n,a)),t)}return isInteger(r)?sub(besselJ(r,e),mul(complex(0,1),besselY(r,e))):(t=sub(mul(besselJ(r,e),exp(mul(r,complex(0,pi)))),besselJ(neg(r),e)),div(mul(complex(0,-1),t),sin(mul(r,pi))))}function airyAi(r){var e;return isComplex(r)?isZero(r)?complex(1/3**(2/3)/gamma(2/3)):r.re<0?(e=mul(2/3,pow(neg(r),1.5)),mul(1/3,sqrt(neg(r)),add(besselJ(1/3,e),besselJ(-1/3,e)))):(e=mul(2/3,pow(r,1.5)),mul(1/pi,sqrt(div(r,3)),besselK(1/3,e))):0===r?1/3**(2/3)/gamma(2/3):r<0?(e=2/3*(-r)**1.5,sqrt(-r)/3*(besselJ(1/3,e)+besselJ(-1/3,e))):(e=2/3*r**1.5,1/pi*sqrt(r/3)*besselK(1/3,e))}function airyAiPrime(r){var e;return isComplex(r)?isZero(r)?complex(-1/3**(1/3)/gamma(1/3)):r.re<0?(e=mul(2/3,pow(neg(r),1.5)),mul(1/3,r,sub(besselJ(-2/3,e),besselJ(2/3,e)))):(e=mul(2/3,pow(r,1.5)),mul(-1/pi/sqrt(3),r,besselK(2/3,e))):0===r?-1/3**(1/3)/gamma(1/3):r<0?r/3*(besselJ(-2/3,e=2/3*(-r)**1.5)-besselJ(2/3,e)):(e=2/3*r**1.5,-1/pi/sqrt(3)*r*besselK(2/3,e))}function airyBi(r){var e;return isComplex(r)?isZero(r)?complex(1/3**(1/6)/gamma(2/3)):r.re<0?(e=mul(2/3,pow(neg(r),1.5)),mul(sqrt(div(neg(r),3)),sub(besselJ(-1/3,e),besselJ(1/3,e)))):(e=mul(2/3,pow(r,1.5)),mul(sqrt(div(r,3)),add(besselI(1/3,e),besselI(-1/3,e)))):0===r?1/3**(1/6)/gamma(2/3):r<0?(e=2/3*(-r)**1.5,sqrt(-r/3)*(besselJ(-1/3,e)-besselJ(1/3,e))):(e=2/3*r**1.5,sqrt(r/3)*(besselI(1/3,e)+besselI(-1/3,e)))}function airyBiPrime(r){var e;return isComplex(r)?isZero(r)?complex(3**(1/6)/gamma(1/3)):r.re<0?(e=mul(2/3,pow(neg(r),1.5)),mul(1/sqrt(3),neg(r),add(besselJ(2/3,e),besselJ(-2/3,e)))):(e=mul(2/3,pow(r,1.5)),mul(1/sqrt(3),r,add(besselI(2/3,e),besselI(-2/3,e)))):0===r?3**(1/6)/gamma(1/3):r<0?(e=2/3*(-r)**1.5,-r/sqrt(3)*(besselJ(2/3,e)+besselJ(-2/3,e))):(e=2/3*r**1.5,r/sqrt(3)*(besselI(2/3,e)+besselI(-2/3,e)))}function sphericalBesselJ(r,e){return mul(div(Math.sqrt(pi/2),sqrt(e)),besselJ(add(r,.5),e))}function sphericalBesselY(r,e){return mul(div(Math.sqrt(pi/2),sqrt(e)),besselY(add(r,.5),e))}function sphericalHankel1(r,e){return mul(div(Math.sqrt(pi/2),sqrt(e)),hankel1(add(r,.5),e))}function sphericalHankel2(r,e){return mul(div(Math.sqrt(pi/2),sqrt(e)),hankel2(add(r,.5),e))}function struveH(r,e){return mul(pow(e,add(r,1)),inv(mul(pow(2,r),sqrt(pi),gamma(add(r,1.5)))),hypergeometric1F2(1,1.5,add(r,1.5),mul(-.25,pow(e,2))))}function struveL(r,e){return mul(pow(e,add(r,1)),inv(mul(pow(2,r),sqrt(pi),gamma(add(r,1.5)))),hypergeometric1F2(1,1.5,add(r,1.5),mul(.25,pow(e,2))))}function jacobiTheta(r,e,i,a=1e-10){if(1<=abs(i))throw Error("Unsupported elliptic nome");if(![1,2,3,4].includes(r))throw Error("Undefined Jacobi theta index");if(isComplex(e)||isComplex(i)){isComplex(e)||(e=complex(e));var t=div(log(i),complex(0,1));if(Math.abs(e.im)>Math.abs(t.im)||Math.abs(e.re)>Math.PI){var n=Math.floor(e.im/t.im),o=(e=sub(e,mul(n,t)),Math.floor(e.re/Math.PI)),m=(e=sub(e,o*Math.PI),pow(i,-n*n)),s=exp(mul(-2*n,e,complex(0,1)));switch(r){case 1:return mul((-1)**(o+n),m,s,chop(jacobiTheta(r,e,i),a));case 2:return mul((-1)**o,m,s,chop(jacobiTheta(r,e,i),a));case 3:return mul(m,s,chop(jacobiTheta(r,e,i),a));case 4:return mul((-1)**n,m,s,chop(jacobiTheta(r,e,i),a))}}switch(r){case 1:for(var l=complex(0),o=complex(1),u=0;Math.abs(o.re)>a||Math.abs(o.im)>a;)l=add(l,o=mul((-1)**u,pow(i,u*u+u),sin(mul(2*u+1,e)))),u++;return mul(2,pow(i,.25),l);case 2:for(l=complex(0),o=complex(1),u=0;Math.abs(o.re)>a||Math.abs(o.im)>a;)l=add(l,o=mul(pow(i,u*u+u),cos(mul(2*u+1,e)))),u++;return mul(2,pow(i,.25),l);case 3:for(l=complex(0),o=complex(1),u=1;Math.abs(o.re)>a||Math.abs(o.im)>a;)l=add(l,o=mul(pow(i,u*u),cos(mul(2*u,e)))),u++;return add(1,mul(2,l));case 4:for(l=complex(0),o=complex(1),u=1;Math.abs(o.re)>a||Math.abs(o.im)>a;)l=add(l,o=mul(pow(neg(i),u*u),cos(mul(2*u,e)))),u++;return add(1,mul(2,l))}}else switch(r){case 1:if(i<0)return jacobiTheta(r,e,complex(i));for(l=0,o=1,u=0;Math.abs(o)>a;)l+=o=(-1)**u*i**(u*u+u)*sin((2*u+1)*e),u++;return 2*i**.25*l;case 2:if(i<0)return jacobiTheta(r,e,complex(i));for(l=0,o=1,u=0;Math.abs(o)>a;)l+=o=i**(u*u+u)*cos((2*u+1)*e),u++;return 2*i**.25*l;case 3:for(l=0,o=1,u=1;Math.abs(o)>a;)l+=o=i**(u*u)*cos(2*u*e),u++;return 1+2*l;case 4:for(l=0,o=1,u=1;Math.abs(o)>a;)l+=o=(-i)**(u*u)*cos(2*u*e),u++;return 1+2*l}}function ellipticNome(r){if(void 0===r)throw Error("Elliptic parameter is undefined");return isComplex(r)?exp(div(mul(-pi,ellipticK(sub(1,r))),ellipticK(r))):1<r?ellipticNome(complex(r)):r<0?-exp(-pi*ellipticK(1/(1-r))/ellipticK(r/(r-1))):exp(-pi*ellipticK(1-r)/ellipticK(r))}function fundamentalParallelogram(r,e,i){var a=(r.re*i.im-r.im*i.re)/(e.re*i.im-e.im*i.re),t=(r.im*e.re-r.re*e.im)/(e.re*i.im-e.im*i.re);return add(r,mul(-Math.floor(a),e),mul(-Math.floor(t),i))}function sn(r,e){var i,a;return 1<e||isComplex(r)||isComplex(e)?1<abs(e=isComplex(e)?e:complex(e))?mul(inv(sqrt(e)),sn(mul(sqrt(e),r),inv(e))):(a=div(r=fundamentalParallelogram(r,mul(4,ellipticK(e)),mul(complex(0,2),ellipticK(sub(1,e)))),pow(jacobiTheta(3,0,i=ellipticNome(e)),2)),mul(div(jacobiTheta(3,0,i),jacobiTheta(2,0,i)),div(jacobiTheta(1,a,i),jacobiTheta(4,a,i)))):0===e?sin(r):1===e?tanh(r):(a=r/jacobiTheta(3,0,i=ellipticNome(e))**2,e<0?jacobiTheta(3,0,i)/jacobiTheta(4,a,i)*div(jacobiTheta(1,a,i),jacobiTheta(2,0,i)).re:jacobiTheta(3,0,i)/jacobiTheta(2,0,i)*jacobiTheta(1,a,i)/jacobiTheta(4,a,i))}function cn(r,e){var i,a;return 1<e||isComplex(r)||isComplex(e)?1<abs(e=isComplex(e)?e:complex(e))?dn(mul(sqrt(e),r),inv(e)):(r=fundamentalParallelogram(r,i=mul(4,ellipticK(e)),add(div(i,2),mul(complex(0,2),ellipticK(sub(1,e))))),a=div(r,pow(jacobiTheta(3,0,i=ellipticNome(e)),2)),mul(div(jacobiTheta(4,0,i),jacobiTheta(2,0,i)),div(jacobiTheta(2,a,i),jacobiTheta(4,a,i)))):0===e?cos(r):1===e?sech(r):(a=r/jacobiTheta(3,0,i=ellipticNome(e))**2,e<0?jacobiTheta(4,0,i)/jacobiTheta(4,a,i)*div(jacobiTheta(2,a,i),jacobiTheta(2,0,i)).re:jacobiTheta(4,0,i)/jacobiTheta(2,0,i)*jacobiTheta(2,a,i)/jacobiTheta(4,a,i))}function dn(r,e){var i,a;return 1<e||isComplex(r)||isComplex(e)?1<abs(e=isComplex(e)?e:complex(e))?cn(mul(sqrt(e),r),inv(e)):(a=div(r=fundamentalParallelogram(r,mul(2,ellipticK(e)),mul(complex(0,4),ellipticK(sub(1,e)))),pow(jacobiTheta(3,0,i=ellipticNome(e)),2)),mul(div(jacobiTheta(4,0,i),jacobiTheta(3,0,i)),div(jacobiTheta(3,a,i),jacobiTheta(4,a,i)))):0===e?1:1===e?sech(r):(a=r/jacobiTheta(3,0,i=ellipticNome(e))**2,jacobiTheta(4,0,i)/jacobiTheta(3,0,i)*jacobiTheta(3,a,i)/jacobiTheta(4,a,i))}function am(r,e){if(1<e||isComplex(r)||isComplex(e)){if(isComplex(r)||(r=complex(r)),0===(e=isComplex(e)?e:complex(e)).im&&e.re<=1){var i,a=ellipticK(e.re);if(r=sub(r,2*(i=Math.round(r.re/2/a))*a),e.re<0){var t=ellipticK(1-e.re);if(1&Math.round(r.im/2/t.re))return sub(i*pi,arcsin(sn(r,e)))}return add(arcsin(sn(r,e)),i*pi)}return arcsin(sn(r,e))}return a=ellipticK(e),r-=2*(i=Math.round(r/2/a))*a,Math.asin(sn(r,e))+i*pi}function weierstrassRoots(r,e){function i(r,e,i){return isZero(r)?mul(root(e,3),exp(complex(0,2*pi*i/3))):mul(2/sqrt(3),sqrt(r),cos(sub(div(arccos(mul(3*sqrt(3)/2,e,pow(r,-1.5))),3),2*pi*i/3)))}return[i(r=div(r,4),e=div(e,4),0),i(r,e,1),i(r,e,2)]}function weierstrassHalfPeriods(r,e){var[r,e,i]=weierstrassRoots(r,e),a=sqrt(sub(r,i)),e=div(sub(e,i),sub(r,i));return[div(ellipticK(e),a),div(mul(complex(0,1),ellipticK(sub(1,e))),a)]}function weierstrassInvariants(r,e){isComplex(r)||(r=complex(r)),(e=isComplex(e)?e:complex(e)).im/e.re<r.im/r.re&&([r,e]=[e,r]);var i,e=div(e,r),e=(e.im<0&&(e.im=-e.im,i=!0),exp(mul(complex(0,1),pi,e))),a=jacobiTheta(2,0,e),e=jacobiTheta(3,0,e),t=mul(4/3*pi**4,pow(mul(2,r),-4),add(pow(a,8),mul(-1,pow(a,4),pow(e,4)),pow(e,8))),r=mul(8/27*pi**6,pow(mul(2,r),-6),add(pow(a,12),mul(-1.5,pow(a,8),pow(e,4)),mul(-1.5,pow(a,4),pow(e,8)),pow(e,12)));return i&&(t.im=-t.im,r.im=-r.im),[t,r]}function weierstrassP(r,e,i){var a;return isComplex(r)||(r=complex(r)),isZero(e)&&isZero(i)?pow(r,-2):([e,i,a]=weierstrassRoots(e,i),i=div(sub(i,a),sub(e,a)),add(a,mul(sub(e,a),pow(sn(mul(r,sqrt(sub(e,a))),i),-2))))}function weierstrassPPrime(r,e,i){var a;return isComplex(r)||(r=complex(r)),isZero(e)&&isZero(i)?mul(-2,pow(r,-3)):([e,i,a]=weierstrassRoots(e,i),i=div(sub(i,a),sub(e,a)),r=mul(r,sqrt(sub(e,a))),mul(-2,pow(sub(e,a),1.5),cn(r,i),dn(r,i),pow(sn(r,i),-3)))}function inverseWeierstrassP(r,e,i){isComplex(r)||(r=complex(r));var[e,i,a]=weierstrassRoots(e,i);return carlsonRF(sub(r,e),sub(r,i),sub(r,a))}function kleinJ(r){var r=exp(mul(complex(0,pi),r)),e=chop(jacobiTheta(2,0,r)),i=chop(jacobiTheta(3,0,r)),r=chop(jacobiTheta(4,0,r));return div(pow(add(pow(e,8),pow(i,8),pow(r,8)),3),mul(54,pow(mul(e,i,r),8)))}function carlsonRC(r,e){return r<0||e<0||isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),r.re===e.re&&r.im===e.im?inv(sqrt(r)):div(arccos(div(sqrt(r),sqrt(e))),mul(sqrt(e),sqrt(sub(1,div(r,e)))))):r===e?1/Math.sqrt(r):r<e?Math.acos(Math.sqrt(r/e))/Math.sqrt(e-r):Math.acosh(Math.sqrt(r/e))/Math.sqrt(r-e)}function carlsonRD(r,e,i){return carlsonRJ(r,e,i,i)}function carlsonRF(r,e,i,a=1e-10){if(isComplex(r)||isComplex(e)||isComplex(i)){for(var t=r,n=e,o=i,m=A0=div(add(r,e,i),3),s=Math.pow(3*a,-1/6)*Math.max(abs(sub(A0,r)),abs(sub(A0,e)),abs(sub(A0,i))),l=.25,u=1;;){var p=sqrt(t),c=sqrt(n),d=sqrt(o),f=add(mul(p,c),mul(p,d),mul(c,d)),h=mul(add(m,f),l);if(t=mul(add(t,f),l),n=mul(add(n,f),l),o=mul(add(o,f),l),u*s<abs(m))break;m=h,u*=l}var b=div(u,m),g=neg(add(M=mul(sub(A0,r),b),C=mul(sub(A0,e),b))),v=sub(mul(M,C),mul(g,g)),x=mul(M,C,g);return mul(pow(m,-.5),add(9240,mul(-924,v),mul(385,v,v),mul(660,x),mul(-630,v,x)),1/9240)}if(e===i)return carlsonRC(r,e);if(r===i)return carlsonRC(e,r);if(r===e)return carlsonRC(i,r);if(r<0||e<0||i<0)return carlsonRF(complex(r),e,i);for(t=r,n=e,o=i,m=A0=(r+e+i)/3,s=Math.pow(3*a,-1/6)*Math.max(Math.abs(A0-r),Math.abs(A0-e),Math.abs(A0-i)),l=.25,u=1;;){h=(m+(f=(p=Math.sqrt(t))*(c=Math.sqrt(n))+p*(d=Math.sqrt(o))+c*d))*l;if(t=(t+f)*l,n=(n+f)*l,o=(o+f)*l,u*s<Math.abs(m))break;m=h,u*=l}var M,C,b=u/m,v=(M=(A0-r)*b)*(C=(A0-e)*b)-(g=-M-C)**2,x=M*C*g;return Math.pow(m,-.5)*(9240-924*v+385*v**2+660*x-630*v*x)/9240}function carlsonRG(r,e,i){var a=mul(i,carlsonRF(r,e,i)),t=mul(-1/3,sub(r,i),sub(e,i),carlsonRD(r,e,i)),r=sqrt(mul(r,e,inv(i)));return mul(.5,add(a,t,r))}function carlsonRJ(r,e,i,a,t=1e-10){if(isComplex(r)||isComplex(e)||isComplex(i)||isComplex(a)){for(var n=r,o=e,m=i,s=a,l=Am=div(add(r,e,i,mul(2,a)),5),u=mul(sub(a,r),sub(a,e),sub(a,i)),p=Math.pow(.25*t,-1/6)*Math.max(abs(sub(l,r)),abs(sub(l,e)),abs(sub(l,i)),abs(sub(l,a))),c=.25,d=1,f=complex(0);;){var h=sqrt(n),b=sqrt(o),g=sqrt(m),v=sqrt(s),x=add(mul(h,b),mul(h,g),mul(b,g)),M=mul(add(Am,x),c),C=(n=mul(add(n,x),c),o=mul(add(o,x),c),m=mul(add(m,x),c),s=mul(add(s,x),c),mul(add(v,h),add(v,b),add(v,g))),w=mul(u,d**3,inv(C),inv(C));if(d*p<abs(Am))break;var y=mul(carlsonRC(1,add(1,w)),d,inv(C));f=add(f,y),d*=c,Am=M}var I=div(d,Am),A=div(add(Z=mul(sub(l,r),I),T=mul(sub(l,e),I),j=mul(sub(l,i),I)),-2),q=add(mul(Z,T),mul(Z,j),mul(T,j),mul(-3,A,A)),E=add(mul(Z,T,j),mul(2,q,A),mul(4,A,A,A)),P=mul(add(mul(2,Z,T,j),mul(q,A),mul(3,A,A,A)),A),N=mul(Z,T,j,A,A),F=(A=add(24024,mul(-5148,q),mul(2457,q,q),mul(4004,E),mul(-4158,q,E),mul(-3276,P),mul(2772,N)),mul(d,pow(Am,-1.5),A,1/24024));return add(F,mul(6,f))}if(r<0||e<0||i<0||a<0)return carlsonRJ(complex(r),e,i,a);for(var Z,T,j,n=r,o=e,m=i,s=a,l=Am=(r+e+i+2*a)/5,u=(a-r)*(a-e)*(a-i),p=Math.pow(.25*t,-1/6)*Math.max(Math.abs(l-r),Math.abs(l-e),Math.abs(l-i),Math.abs(l-a)),c=.25,d=1,f=0;;){h=Math.sqrt(n),b=Math.sqrt(o),g=Math.sqrt(m),v=Math.sqrt(s),x=h*b+h*g+b*g,M=(Am+x)*c;n=(n+x)*c,o=(o+x)*c,m=(m+x)*c,s=(s+x)*c;w=u*d**3/(C=(v+h)*(v+b)*(v+g))**2;if(d*p<Math.abs(Am))break;f+=y=carlsonRC(1,1+w)*d/C,d*=c,Am=M}return A=24024-5148*(q=(Z=(l-r)*(I=d/Am))*(T=(l-e)*I)+Z*(j=(l-i)*I)+T*j-3*(A=(-Z-T-j)/2)**2)+2457*q**2+4004*(E=Z*T*j+2*q*A+4*A**3)-4158*q*E-3276*(P=(2*Z*T*j+q*A+3*A**3)*A)+2772*(N=Z*T*j*A**2),(F=d*Math.pow(Am,-1.5)*A/24024)+6*f}function ellipticF(r,e){var i,a;return 1===arguments.length&&(e=r,r=pi/2),isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),i=complex(0),Math.abs(r.re)>pi/2&&(a=Math.round(r.re/pi),r.re=r.re-a*pi,i=mul(2*a,ellipticK(e))),add(mul(sin(r),carlsonRF(mul(cos(r),cos(r)),sub(1,mul(e,sin(r),sin(r))),1)),i)):1<e&&Math.abs(r)>Math.asin(1/Math.sqrt(e))?ellipticF(complex(r),e):(i=0,Math.abs(r)>pi/2&&(r-=(a=Math.round(r/pi))*pi,i=2*a*ellipticK(e)),sin(r)*carlsonRF(cos(r)**2,1-e*sin(r)**2,1)+i)}function ellipticK(r){if(void 0===r)throw Error("Elliptic parameter is undefined");return ellipticF(r)}function ellipticE(r,e){var i,a;return 1===arguments.length&&(e=r,r=pi/2),isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),i=complex(0),Math.abs(r.re)>pi/2&&(a=Math.round(r.re/pi),r.re=r.re-a*pi,i=mul(2*a,ellipticE(e))),add(mul(sin(r),carlsonRF(mul(cos(r),cos(r)),sub(1,mul(e,sin(r),sin(r))),1)),mul(-1/3,e,pow(sin(r),3),carlsonRD(mul(cos(r),cos(r)),sub(1,mul(e,sin(r),sin(r))),1)),i)):1<e&&Math.abs(r)>Math.asin(1/Math.sqrt(e))?ellipticE(complex(r),e):(i=0,Math.abs(r)>pi/2&&(r-=(a=Math.round(r/pi))*pi,i=2*a*ellipticE(e)),sin(r)*carlsonRF(cos(r)**2,1-e*sin(r)**2,1)-e/3*sin(r)**3*carlsonRD(cos(r)**2,1-e*sin(r)**2,1)+i)}function ellipticPi(r,e,i){var a,t;return 2===arguments.length&&(i=e,e=pi/2),isComplex(r)||isComplex(e)||isComplex(i)?(isComplex(e)||(e=complex(e)),a=complex(0),Math.abs(e.re)>pi/2&&(t=Math.round(e.re/pi),e.re=e.re-t*pi,a=mul(2*t,ellipticPi(r,i))),add(mul(sin(e),carlsonRF(mul(cos(e),cos(e)),sub(1,mul(i,sin(e),sin(e))),1)),mul(1/3,r,pow(sin(e),3),carlsonRJ(mul(cos(e),cos(e)),sub(1,mul(i,sin(e),sin(e))),1,sub(1,mul(r,sin(e),sin(e))))),a)):1<r&&Math.abs(e)>Math.asin(1/Math.sqrt(r))||1<i&&Math.abs(e)>Math.asin(1/Math.sqrt(i))?ellipticPi(r,complex(e),i):(a=0,Math.abs(e)>pi/2&&(e-=(t=Math.round(e/pi))*pi,a=2*t*ellipticPi(r,i)),sin(e)*carlsonRF(cos(e)**2,1-i*sin(e)**2,1)+r/3*sin(e)**3*carlsonRJ(cos(e)**2,1-i*sin(e)**2,1,1-r*sin(e)**2)+a)}function jacobiZeta(r,e){return sub(ellipticE(r,e),mul(ellipticF(r,e),ellipticE(e),inv(ellipticK(e))))}function factorial(r){if(isComplex(r))return isPositiveIntegerOrZero(r)?complex(factorial(r.re)):gamma(add(r,1));if(isPositiveIntegerOrZero(r)){if(factorialCache[r])return factorialCache[r];for(var e=factorialCache.length-1,i=factorialCache[e],a=1+e;a<=r;a++)factorialCache[a]=i*=a;return i}return gamma(r+1)}function factorial2(r){var e,i;if(isComplex(r))return isPositiveIntegerOrZero(r)?complex(factorial2(r.re)):(e=pow(2,div(r,2)),i=pow(pi/2,div(sub(cos(mul(pi,r)),1),4)),mul(e,i,gamma(add(div(r,2),1))));if(0===r)return 1;if(isPositiveInteger(r)){for(var a=1&r?1:2,t=a+2;t<=r;t+=2)a*=t;return a}return 2**(r/2)*(pi/2)**((cos(pi*r)-1)/4)*gamma(r/2+1)}function binomial(r,e){return isComplex(r)||isComplex(e)?div(factorial(r),mul(factorial(sub(r,e)),factorial(e))):Number.isInteger(e)&&e<0&&0<=r||Number.isInteger(r)&&Number.isInteger(e)&&0<=r&&r<e?0:factorial(r)/factorial(r-e)/factorial(e)}function multinomial(r){if(1===arguments.length)return isComplex(r)?complex(1):1;for(var e=0,i=1,a=0,t=0;t<arguments.length;t++){var n,o=arguments[t],e=add(e,o);isNegativeInteger(o)?(i=div(i,mul(chop(pow(-1,n=sub(-1,o))),factorial(n))),a++):i=mul(i,factorial(arguments[t]))}return isNegativeInteger(e)?0<--a?isComplex(e)?complex(0):0:inv(mul(i,chop(pow(-1,n=sub(-1,e))),factorial(n))):0<a?isComplex(e)?complex(0):0:div(factorial(e),i)}function pochhammer(r,e){var i=isArbitrary(r)?arb1:1;if(isZero(e))return isComplex(r)||isComplex(e)?complex(i):i;if(isComplex(e))return isPositiveInteger(e)?isComplex(a=pochhammer(r,e.re))?a:complex(a):div(gamma(add(r,e=isArbitrary(r)&&!isArbitrary(e)?arbitrary(e):e)),gamma(r));if(isPositiveInteger(e)){for(var a=r,t=i,n=1;n<e;)a=mul(a,add(r,t)),t=add(t,i),n++;return a}return div(gamma(add(r,e=isArbitrary(r)&&!isArbitrary(e)?arbitrary(e):e)),gamma(r))}function subfactorial(r){var e=div(gamma(add(r,1),-1),exp(1));return isPositiveInteger(r)?round(e):e}function logGamma(r){if(isArbitrary(r)){var e=10n*arb1;if(isNegativeIntegerOrZero(arbitrary(r)))throw Error("Gamma function pole");if(abs(r)<e){for(var i=isComplex(r)?r.re:r,a=Math.ceil(arbitrary(e)-arbitrary(i)),t=ln(r),n=arb1,o=1;o<a;)t=add(t,ln(add(r,n))),n=add(n,arb1),o++;return sub(logGamma(add(r,arbitrary(a))),t)}if((r=r<0n?complex(r):r).re<0n){var m,s=arb1;if(0===abs(r.im))h=neg(ln(sin(mul(r,onePi))));else if(r.im<0n){for(m=exp(mul(r,complex(0n,-twoPi))),p=complex(m.re,m.im),h=complex(m.re,m.im);0n!==p.re||0n!==p.im;)s+=arb1,h=add(h,div(p=mul(p,m),s));h=add(h,mul(r,complex(0n,-onePi)),ln(arb2))}else{for(m=exp(mul(r,complex(0n,twoPi))),p=complex(m.re,m.im),h=complex(m.re,m.im);0n!==p.re||0n!==p.im;)s+=arb1,h=add(h,div(p=mul(p,m),s));h=add(h,mul(r,complex(0n,onePi)),complex(0n,-onePi),ln(arb2))}return add(h,ln(onePi),neg(logGamma(sub(arb1,r))),complex(0n,halfPi))}var l,s=1,u=arb1,p=1n,c=0n;{function d(){return 0n!==p.re||0n!==p.im}function d(){return 0n!==p}l=isComplex(r)?complex(r.re,r.im):r}for(;d();){if(s===bernoulli2nN.length){console.log("Not enough Bernoulli numbers for logGamma");break}c=add(c,p=div(div(bernoulli2nN[s],bernoulli2nD[s]),mul(u+arb1,u,l))),l=mul(l,r,r),u+=arb2,s++}return add(mul(sub(r,arb1/2n),ln(r)),neg(r),div(ln(twoPi),arb2),c)}var f=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNegativeIntegerOrZero(r))throw Error("Gamma function pole");if(isComplex(r)){if(r.re<0)return e=log(div(pi,sin(mul(pi,r)))),isNegativeIntegerOrZero((r.re+.5)/2)&&(e.im=pi*(0<r.im?1:-1)),h=sub(e,logGamma(sub(1,r))),c=r.im<0?-1:1,i=0===r.im?.25:0,add(h,complex(0,2*c*(s=Math.ceil(r.re/2-.75+i))*pi));for(var h=add(r,5.2421875),c=(h=sub(mul(add(r,.5),log(h)),h),.9999999999999971),b=0;b<14;b++)c=add(c,div(f[b],add(r,b+1)));e=add(h,log(mul(2.5066282746310007,div(c,r))));return e=c.re<0&&(r.im<0&&div(c,r).im<0&&(e=add(e,complex(0,2*pi))),0<r.im)&&0<div(c,r).im?add(e,complex(0,-2*pi)):e}if(r<0)return logGamma(complex(r));for(c=(h=(r+.5)*log(h=r+5.2421875)-h,.9999999999999971),b=0;b<14;b++)c+=f[b]/(r+b+1);return h+log(2.5066282746310007*c/r)}function gamma(r,e,i){if(2!==arguments.length)return 3===arguments.length?isZero(e)?mul(pow(i,r),inv(r),hypergeometric1F1(r,add(r,1),neg(i))):sub(gamma(r,0,i),gamma(r,0,e)):isPositiveInteger(r)?factorial(sub(r,1)):!isComplex(r)&&r<0?exp(logGamma(complex(r))).re:exp(logGamma(r));if(isZero(r)){if(isZero(e))throw Error("Gamma function pole");var a=neg(expIntegralEi(neg(e),!0));return a=e<0||e.re<0&&0===e.im?sub(a,complex(0,pi)):a}if(isNegativeInteger(r)){for(var t=isComplex(r)?-r.re:-r,n=inv(e),o=n,m=1;m<t;m++)n=add(n,o=mul(o,-m,inv(e)));i=mul(exp(neg(e)),n),a=sub(neg(expIntegralEi(neg(e),!0,1e-14)),i);return(e<0||e.re<0&&0===e.im)&&(a=sub(a,complex(0,pi))),a=mul((-1)**t/factorial(t),a),isComplex(r)&&!isComplex(a)?complex(a):a}return mul(exp(neg(e)),hypergeometricU(sub(1,r),sub(1,r),e))}function gammaRegularized(r,e,i){return div(3===arguments.length?gamma(r,e,i):gamma(r,e),gamma(r))}function beta(r,e,i,a){return 4===arguments.length?sub(beta(e,i,a),beta(r,i,a)):3===arguments.length?mul(pow(r,e),inv(e),hypergeometric2F1(e,sub(1,i),add(e,1),r)):div(mul(gamma(r),gamma(e)),gamma(add(r,e)))}function betaRegularized(r,e,i,a){return 4===arguments.length?div(beta(r,e,i,a),beta(i,a)):div(beta(r,e,i),beta(e,i))}function polygamma(r,e){if(1===arguments.length)return digamma(e);if(isPositiveInteger(r))return mul((-1)**(r+1)*factorial(r),hurwitzZeta(r+1,e));throw Error("Unsupported polygamma index")}function digamma(r){return diff(r=>logGamma(r),r)}function erf(r){var e=Math.abs(arg(r));return 5<abs(r)&&(e<pi/4||3*pi/4<e)?sub(1,erfc(r)):mul(2/sqrt(pi),r,hypergeometric1F1(.5,1.5,neg(mul(r,r))))}function erfc(r){var e=Math.abs(arg(r));return 5<abs(r)&&(e<pi/4||3*pi/4<e)?(e=mul(1/sqrt(pi),exp(neg(mul(r,r))),inv(r),hypergeometric2F0(.5,1,neg(inv(mul(r,r))))),r.re<0||r<0?add(2,e):e):sub(1,erf(r))}function erfi(r){return mul(complex(0,-1),erf(mul(complex(0,1),r)))}function fresnelS(r){var e=hypergeometric1F1(.5,1.5,mul(complex(0,pi/2),pow(r,2))),i=hypergeometric1F1(.5,1.5,mul(complex(0,-pi/2),pow(r,2))),e=mul(r,sub(e,i),complex(0,-.5));return isComplex(r)?e:e.re}function fresnelC(r){var e=hypergeometric1F1(.5,1.5,mul(complex(0,pi/2),pow(r,2))),i=hypergeometric1F1(.5,1.5,mul(complex(0,-pi/2),pow(r,2))),e=mul(r,add(e,i),.5);return isComplex(r)?e:e.re}function expIntegralEi(r,e=!1,i=1e-10){if(isUnity(neg(r)))return complexAverage(r=>expIntegralEi(r,e,i),r);var a=mul(r,complex(0,1));if(isUnity(a)||isUnity(neg(a)))return complexAverage(r=>expIntegralEi(r,e,i),r,complex(0,1e-5));if(isComplex(r)){if(26<abs(r)){for(var t=complex(1),n=s=complex(1),o=1;(Math.abs(s.re)>i||Math.abs(s.im)>i)&&!(abs(s=mul(s,o,inv(r)))>abs(n));)t=add(t,s),o++,n=s;return e?mul(t,exp(r),inv(r)):(l=0<r.im?1:r.im<0?-1:0,add(mul(t,exp(r),inv(r)),complex(0,l*pi)))}a=abs(sub(r,26))/26;if(1<a&&1.5<abs(r)){setPrecisionScale(17+Math.round(10*(a-1)));for(var m=arbitrary(r),t=arbitrary(complex(0)),s=arbitrary(complex(1)),o=arb1;0n!==div(s.re,o)||0n!==div(s.im,o);)s=div(mul(s,m),o),t=add(t,div(s,o)),o=add(o,arb1);t=add(t,getConstant("eulerGamma"),ln(m)),t=arbitrary(t=e?add(t,complex(0n,(l=0n<r.im?-1n:r.im<0n?1n:0n)*onePi)):t),resetPrecisionScale(),0<r.im&&0===r.re&&(t.im+=pi)}else{for(var l,t=complex(0),s=complex(1),o=1;Math.abs(s.re/o)>i||Math.abs(s.im/o)>i;)t=add(t,div(s=mul(s,r,1/o),o)),o++;t=add(t,eulerGamma,log(r)),e&&(t=add(t,complex(0,(l=0<r.im?-1:r.im<0?1:0)*pi)))}return r.re<0&&0===r.im&&(t.im=0),t}if(r<0)return expIntegralEi(complex(r)).re;if(26<Math.abs(r)){for(t=1,n=s=1,o=1;Math.abs(s)>i&&(s*=o/r,!(Math.abs(s)>Math.abs(n)));)t+=s,o++,n=s;return t*Math.exp(r)/r}for(t=0,s=1,o=1;Math.abs(s/o)>i;)t+=(s*=r/o)/o,o++;return t+eulerGamma+Math.log(r)}function logIntegral(r){return expIntegralEi(log(r))}function sinIntegral(r){var e;return isZero(r)?isComplex(r)?complex(0):0:(e=mul(complex(0,1),r),e=mul(complex(0,.5),add(gamma(0,neg(e)),neg(gamma(0,e)),log(neg(e)),neg(log(e)))),isComplex(r)?e:e.re)}function cosIntegral(r){var e=mul(complex(0,1),r),e=sub(log(r),mul(.5,add(gamma(0,neg(e)),gamma(0,e),log(neg(e)),log(e))));return 0<r?e.re:(0<r.re&&0===r.im&&(e.im=chop(e.im)),e)}function sinhIntegral(r){var e;return isZero(r)?isComplex(r)?complex(0):0:(e=mul(.5,add(gamma(0,r),neg(gamma(0,neg(r))),log(r),neg(log(neg(r))))),isComplex(r)?e:e.re)}function coshIntegral(r){return mul(-.5,add(gamma(0,r),gamma(0,neg(r)),neg(log(r)),log(neg(r))))}function expIntegralE(r,e){var i;return isZero(r)?div(exp(neg(e)),e):isZero(e)&&(1<r||1<r.re)?inv(sub(r,1)):(i=pow(e,sub(r,1)),isInteger(r)&&e.re<0&&(i.im=chop(i.im)),mul(i,gamma(sub(1,r),e)))}function hypergeometric0F1(r,e,i=1e-10){var a,t,n,o;if(isNegativeIntegerOrZero(r))throw Error("Hypergeometric function pole");if(isComplex(r)||isComplex(e)){if(100<abs(e))return isNegativeIntegerOrZero(sub(r,.5))?(o=complexAverage(r=>hypergeometric0F1(r,e),r),isReal(e)&&(o.im=0)):(a=sub(mul(2,r),1),t=(r=sub(r,.5),e=mul(4,sqrt(e)),mul(gamma(a),pow(neg(e),neg(r)),inv(gamma(sub(a,r))))),t=mul(t,hypergeometric2F0(r,add(r,neg(a),1),div(-1,e))),n=mul(gamma(a),pow(e,sub(r,a)),exp(e),inv(gamma(r))),n=mul(n,hypergeometric2F0(sub(a,r),sub(1,r),div(1,e))),o=mul(exp(div(e,-2)),add(t,n)),isReal(r)&&isReal(e)&&(o.im=0)),o;for(var m=complex(1),s=complex(1),l=1;Math.abs(s.re)>i||Math.abs(s.im)>i;)m=add(m,s=mul(s,e,inv(r),1/l)),r=add(r,1),l++}else{if(100<Math.abs(e))return hypergeometric0F1(r,complex(e)).re;for(m=1,s=1,l=1;Math.abs(s)>i;)m+=s*=e/r/l,r++,l++}return m}function hypergeometric1F1(r,e,i,a=1e-10){var t,n,o;if(isEqualTo(r,e))return isNegativeInteger(r)?summation(r=>div(pow(i,r),factorial(r)),[0,isComplex(r)?-r.re:-r]):exp(i);if(isArbitrary(i)){if(isArbitrary(r)||(r=arbitrary(r)),isArbitrary(e)||(e=arbitrary(e)),isNegativeIntegerOrZero(arbitrary(e)))throw Error("Hypergeometric function pole");if(isComplex(r)||isComplex(e)||isComplex(i)){if((i=isComplex(i)?i:complex(i)).re<0n)return mul(exp(i),hypergeometric1F1(sub(e,r),e,neg(i)));for(var m=complex(arb1),s=complex(arb1),l=arb1;0n!==abs(s.re)||0n!==abs(s.im);)m=add(m,s=mul(s,i,r,inv(e),inv(l))),r=add(r,arb1),e=add(e,arb1),l+=arb1}else{if(i<0n)return mul(exp(i),hypergeometric1F1(e-r,e,-i));for(m=arb1,s=arb1,l=arb1;0n!==abs(s);)m+=s=mul(s,i,r,inv(e),inv(l)),r+=arb1,e+=arb1,l+=arb1}}else{var u;if(isNegativeIntegerOrZero(e))throw Error("Hypergeometric function pole");if(isComplex(r)||isComplex(e)||isComplex(i)){if(isZero(r))return complex(1);if((i=isComplex(i)?i:complex(i)).re<0)return mul(exp(i),hypergeometric1F1(sub(e,r),e,neg(i)));if(30<abs(i))return isZero(r)||isNegativeIntegerOrZero(sub(e,r))?complexAverage(r=>hypergeometric1F1(r,e,i),r):(u=mul(gamma(e),pow(neg(i),neg(r)),inv(gamma(sub(e,r))),hypergeometric2F0(r,add(r,neg(e),1),div(-1,i))),u=add(u,mul(gamma(e),pow(i,sub(r,e)),exp(i),inv(gamma(r)),hypergeometric2F0(sub(e,r),sub(1,r),div(1,i)))),isReal(r)&&isReal(e)&&isReal(i)&&(u.im=0),u);if(t=i,o=Math.sqrt(3)-1,0<t.re?(n=o*t.re+15)<t.im||t.im<-n:(n=-o*t.re+15)<t.im||t.im<-n)return setPrecisionScale(22),u=arbitrary(hypergeometric1F1(r,e,arbitrary(i))),resetPrecisionScale(),u;for(m=complex(1),s=complex(1),l=1;Math.abs(s.re)>a||Math.abs(s.im)>a;)m=add(m,s=mul(s,i,r,inv(e),1/l)),r=add(r,1),e=add(e,1),l++}else{if(isZero(r))return 1;if(i<0)return exp(i)*hypergeometric1F1(e-r,e,-i);if(30<Math.abs(i))return hypergeometric1F1(r,e,complex(i)).re;for(m=1,s=1,l=1;Math.abs(s)>a;)m+=s*=i*r/e/l,r++,e++,l++}}return m}function hypergeometricU(e,r,i){var a,t,n;return isEqualTo(add(e,1),r)?pow(i,neg(e)):isZero(e)?isComplex(e)||isComplex(r)||isComplex(i)?complex(1):1:25<abs(i)?mul(pow(i,neg(e)),hypergeometric2F0(e,add(e,neg(r),1),neg(inv(i)))):isUnity(e)&&isUnity(r)?mul(exp(i),gamma(0,i)):isUnity(r)?complexAverage(r=>hypergeometricU(e,r,i),r):isPositiveInteger(e)&&isEqualTo(e,r)?mul(exp(i),gamma(sub(1,e),i)):isNegativeInteger(e)?mul((-1)**(a=isComplex(e)?-e.re:-e),pochhammer(r,a),hypergeometric1F1(e,r,i)):(a=mul(gamma(sub(r,1)),inv(gamma(e)),pow(i,sub(1,r)),hypergeometric1F1(add(e,neg(r),1),sub(2,r),i)),t=mul(gamma(sub(1,r)),inv(gamma(add(e,neg(r),1))),hypergeometric1F1(e,r,i)),(n=Math.max(abs(a),abs(t)))<100?add(a,t):(n=+n.toExponential().split("e")[1],setPrecisionScale(defaultDecimals+n),e=arbitrary(e),r=arbitrary(r),i=arbitrary(i),a=mul(gamma(sub(r,arb1)),inv(gamma(e)),pow(i,sub(arb1,r)),hypergeometric1F1(add(e,neg(r),arb1),sub(arb2,r),i)),t=mul(gamma(sub(arb1,r)),inv(gamma(add(e,neg(r),arb1))),hypergeometric1F1(e,r,i)),n=arbitrary(add(a,t)),resetPrecisionScale(),n))}function whittakerM(r,e,i){return mul(exp(mul(-.5,i)),pow(i,add(e,.5)),hypergeometric1F1(add(e,neg(r),.5),add(mul(2,e),1),i))}function whittakerW(r,e,i){return mul(exp(mul(-.5,i)),pow(i,add(e,.5)),hypergeometricU(add(e,neg(r),.5),add(mul(2,e),1),i))}function hypergeometric2F0(r,e,i,a=1e-10){if(isComplex(r)||isComplex(e)||isComplex(i))for(var t=complex(1),n=s=complex(1),o=!1,m=1;(Math.abs(s.re)>a||Math.abs(s.im)>a)&&!(abs(s=mul(s,i,r,e,1/m))>abs(n)&&o);){if(abs(s)<abs(n)&&(o=!0),50<m)throw Error("Not converging after 50 terms");t=add(t,s),r=add(r,1),e=add(e,1),m++,n=s}else for(var s,t=1,n=s=1,o=!1,m=1;Math.abs(s)>a&&(s*=i*r*e/m,!(Math.abs(s)>Math.abs(n)&&o));){if(Math.abs(s)<Math.abs(n)&&(o=!0),50<m)throw Error("Not converging after 50 terms");t+=s,r++,e++,m++,n=s}return t}function hypergeometric2F1(e,i,a,t,r=1e-10){if(isEqualTo(e,a))return pow(sub(1,t),neg(i));if(isEqualTo(i,a))return pow(sub(1,t),neg(e));if(!isUnity(neg(t))&&abs(add(t,1))<r)return hypergeometric2F1(e,i,a,isComplex(t)?complex(-1):-1);if(isNegativeIntegerOrZero(a))throw Error("Hypergeometric function pole");if(isComplex(e)||isComplex(i)||isComplex(a)||isComplex(t)){if(isZero(e)||isZero(i))return complex(1);var n=[abs(t),abs(div(t,sub(t,1))),abs(sub(1,t)),abs(inv(t)),abs(inv(sub(1,t))),abs(sub(1,inv(t)))];switch(n.indexOf(Math.min.apply(null,n))){case 0:break;case 1:return mul(pow(sub(1,t),neg(e)),hypergeometric2F1(e,sub(a,i),a,div(t,sub(t,1))));case 2:return isInteger(sub(a,add(e,i)))||isNegativeIntegerOrZero(sub(a,e))?complexAverage(r=>hypergeometric2F1(r,i,a,t),e):isNegativeIntegerOrZero(sub(a,i))?complexAverage(r=>hypergeometric2F1(e,r,a,t),i):(l=mul(gamma(a),gamma(sub(a,add(e,i))),inv(gamma(sub(a,e))),inv(gamma(sub(a,i))),hypergeometric2F1(e,i,add(e,i,neg(a),1),sub(1,t))),u=mul(pow(sub(1,t),sub(a,add(e,i))),gamma(a),gamma(sub(add(e,i),a)),inv(gamma(e)),inv(gamma(i)),hypergeometric2F1(sub(a,e),sub(a,i),add(a,neg(e),neg(i),1),sub(1,t))),add(l,u));case 3:return isInteger(sub(e,i))||isNegativeIntegerOrZero(sub(a,e))?complexAverage(r=>hypergeometric2F1(r,i,a,t),e):isNegativeIntegerOrZero(sub(a,i))?complexAverage(r=>hypergeometric2F1(e,r,a,t),i):(l=mul(gamma(a),gamma(sub(i,e)),inv(gamma(i)),inv(gamma(sub(a,e))),pow(neg(t),neg(e)),hypergeometric2F1(e,add(1,neg(a),e),add(1,neg(i),e),inv(t))),u=mul(gamma(a),gamma(sub(e,i)),inv(gamma(e)),inv(gamma(sub(a,i))),pow(neg(t),neg(i)),hypergeometric2F1(i,add(1,neg(a),i),add(1,neg(e),i),inv(t))),add(l,u));case 4:return isInteger(sub(e,i))||isNegativeIntegerOrZero(sub(a,e))?complexAverage(r=>hypergeometric2F1(r,i,a,t),e):isNegativeIntegerOrZero(sub(a,i))?complexAverage(r=>hypergeometric2F1(e,r,a,t),i):(l=mul(pow(sub(1,t),neg(e)),gamma(a),gamma(sub(i,e)),inv(gamma(i)),inv(gamma(sub(a,e))),hypergeometric2F1(e,sub(a,i),add(e,neg(i),1),inv(sub(1,t)))),u=mul(pow(sub(1,t),neg(i)),gamma(a),gamma(sub(e,i)),inv(gamma(e)),inv(gamma(sub(a,i))),hypergeometric2F1(i,sub(a,e),add(i,neg(e),1),inv(sub(1,t)))),add(l,u));case 5:return isInteger(sub(a,add(e,i)))||isNegativeIntegerOrZero(sub(a,e))?complexAverage(r=>hypergeometric2F1(r,i,a,t),e):isNegativeIntegerOrZero(sub(a,i))?complexAverage(r=>hypergeometric2F1(e,r,a,t),i):(l=mul(gamma(a),gamma(sub(a,add(e,i))),inv(gamma(sub(a,e))),inv(gamma(sub(a,i))),pow(t,neg(e)),hypergeometric2F1(e,add(e,neg(a),1),add(e,i,neg(a),1),sub(1,inv(t)))),u=mul(gamma(a),gamma(sub(add(e,i),a)),inv(gamma(e)),inv(gamma(i)),pow(sub(1,t),sub(a,add(e,i))),pow(t,sub(e,a)),hypergeometric2F1(sub(a,e),sub(1,e),add(a,neg(e),neg(i),1),sub(1,inv(t)))),add(l,u))}for(var o=complex(1),m=complex(1),s=1;Math.abs(m.re)>r||Math.abs(m.im)>r;)o=add(o,m=mul(m,t,e,i,inv(a),1/s)),e=add(e,1),i=add(i,1),a=add(a,1),s++}else{if(isZero(e)||isZero(i))return 1;var l,u;if(t<-1)return(l=gamma(a)*gamma(i-e)/gamma(i)/gamma(a-e)*(-t)**-e*hypergeometric2F1(e,1-a+e,1-i+e,1/t))+(u=gamma(a)*gamma(e-i)/gamma(e)/gamma(a-i)*(-t)**-i*hypergeometric2F1(i,1-a+i,1-e+i,1/t));if(-1===t)return hypergeometric2F1(e,i,a,complex(t)).re;if(1===t){if(0<a-e-i)return gamma(a)*gamma(a-e-i)/gamma(a-e)/gamma(a-i);throw Error("Divergent Gauss hypergeometric function")}if(1<t)return hypergeometric2F1(e,i,a,complex(t));for(o=1,m=1,s=1;Math.abs(m)>r;)o+=m*=t*e*i/a/s,e++,i++,a++,s++}return o}function hypergeometric1F2(r,e,i,a,t=1e-10){if(isComplex(r)||isComplex(e)||isComplex(i)||isComplex(a)){if(150<abs(a)){var n=add(r,neg(e),neg(i)),o=div(add(n,.5),2),m=[1],s=(m[1]=add(mul(add(mul(3,r),e,i,-2),n,.5),mul(2,e,i),-3/8),add(mul(e,i),mul(n,add(mul(3,r),e,i,-2),.25),-3/16)),l=(m[2]=add(mul(2,s,s),neg(mul(sub(mul(2,r),3),e,i)),mul(n,add(mul(-8,mul(r,r)),mul(11,r),e,i,-2),.25),-3/16),complex(0,1)),u=complex(0,-1);function p(r){return mul(1/2**r,m[r],pow(neg(a),-r/2))}for(var s=p(1),n=p(2),c=add(1,mul(u,s),neg(n)),d=add(1,mul(l,s),neg(n)),f=2,h=p(f),b=powMinusI=-1;abs(h)>t;){f++,b=mul(b,l),powMinusI=mul(powMinusI,u);var g=mul(add(3*f**2,mul(2*f,add(mul(-3,r),e,i,-2)),mul(3,mul(r,r)),neg(mul(sub(e,i),sub(e,i))),neg(mul(2,r,add(e,i,-2))),.25),m[f-1]),v=mul(add(f,neg(r),e,neg(i),-.5),add(f,neg(r),neg(e),i,-.5),add(f,neg(r),e,i,-2.5),m[f-2]);m[f]=div(sub(g,v),2*f),h=p(f),c=add(c,mul(powMinusI,h)),d=add(d,mul(b,h))}s=add(mul(pi,o),mul(2,sqrt(neg(a)))),n=exp(mul(l,s)),s=exp(mul(u,s)),n=add(mul(n,c),mul(s,d)),g=mul(1/(2*sqrt(pi)),inv(gamma(r)),pow(neg(a),o),n),v=mul(inv(gamma(sub(e,r))),inv(gamma(sub(i,r))),pow(neg(a),neg(r)),hypergeometricSeries([r,add(r,neg(e),1),add(r,neg(i),1)],[],inv(a),!0));return mul(gamma(e),gamma(i),add(g,v))}return hypergeometricSeries([r],[e,i],a,!0)}return 150<Math.abs(a)?hypergeometric1F2(r,e,i,complex(a)).re:hypergeometricSeries([r],[e,i],a)}function hypergeometricSeries(r,e,i,a=!1,t=1e-10){if(a)for(var n=complex(1),o=complex(1),m=1;Math.abs(o.re)>t||Math.abs(o.im)>t;){for(var s=0;s<r.length;s++)o=mul(o,r[s]),r[s]=add(r[s],1);for(s=0;s<e.length;s++)o=div(o,e[s]),e[s]=add(e[s],1);n=add(n,o=mul(o,i,1/m)),m++}else for(n=1,o=1,m=1;Math.abs(o)>t;){for(s=0;s<r.length;s++)o*=r[s],r[s]++;for(s=0;s<e.length;s++)o/=e[s],e[s]++;n+=o*=i/m,m++}return n}function hypergeometricPFQ(r,e,i){if(1<abs(i))throw Error("General hypergeometric argument currently restricted");var a=!1;return r.forEach(r=>a=a||isComplex(r)),e.forEach(r=>a=a||isComplex(r)),a||isComplex(i)?hypergeometricSeries(r,e,i,!0):hypergeometricSeries(r,e,i)}function exp(r){if(isArbitrary(r)){if(isComplex(r))return{re:mul(e=exp(r.re),cos(r.im)),im:mul(e,sin(r.im))};for(var e=div(r,ln10)/precisionScale,i=(r-=e*ln10,arb1),a=arb1,t=arb1;0n!==a;)i+=a=div(mul(a,r),t),t+=arb1;return 0n<e&&(i*=10n**e),e<0n&&(i/=10n**-e),i}return isComplex(r)?{re:Math.exp(r.re)*Math.cos(r.im),im:Math.exp(r.re)*Math.sin(r.im)}:Math.exp(r)}function logisticSigmoid(r){return inv(add(1,exp(neg(r))))}function log(r,e){return isComplex(r)?isComplex(e)?div(log(r),log(e)):{re:log(abs(r),e),im:log(Math.E,e)*arg(r)}:r<0?log(complex(r),e):void 0===e?Math.log(r):Math.log(r)/Math.log(e)}function ln(r){function a(r){var e=4n*arb1,i=10n*arb1;return abs(r)<i?sub(a(mul(i,r)),ln10):(i=(r=>{var e=arb1,i=arb1,a=1;if(isComplex(r))for(;0n!==e.re||0n!==e.im;){for(var t=0;t<8*a;t++)e=mul(e,r);i=add(i,e),a++}else for(;0n!==e;){for(t=0;t<8*a;t++)e=mul(e,r);i+=e,a++}return mul(arb2,r,i)})(r=div(arb1,r)),r=(r=>{var e=arb1,i=0n,a=1;if(isComplex(r))for(;0n!==e.re||0n!==e.im;){for(var t=0;t<4*(2*a-1);t++)e=mul(e,r);i=add(i,e),a++}else for(;0n!==e;){for(t=0;t<4*(2*a-1);t++)e=mul(e,r);i+=e,a++}return add(arb1,mul(arb2,i))})(r),div(onePi,mul(e,((r,e)=>{var i,a;if(isComplex(r))for(var t=0;!(r.re===e.re&&r.im===e.im||(r=div(add(i=r,a=e),arb2),e=sqrt(mul(i,a)),20<++t)););else for(;r!==e;)r=div((i=r)+(a=e),arb2),e=sqrt(mul(i,a));return r})(mul(i,i),mul(r,r)))))}if(isArbitrary(r)){if(isComplex(r)){if(r.re===arb1&&0n===r.im)return{re:0n,im:0n};if(0n===r.re&&0n===r.im)throw Error("Arbitrary natural logarithm singularity");var e;return 0n===r.re?0n<r.im?{re:a(r.im),im:halfPi}:{re:a(-r.im),im:-halfPi}:(e=a(r),r.re<0n&&(0n<e.im?e.im-=onePi:e.im+=onePi),e)}if(r===arb1)return 0n;if(0n===r)throw Error("Arbitrary natural logarithm singularity");return r<0n?{re:a(-r),im:onePi}:a(r)}return log(r)}function lambertW(r,e,i=1e-10){if(1===arguments.length&&(e=r,r=0),!Number.isInteger(r))throw Error("Unsupported Lambert W index");if(isZero(e)){if(0===r)return e;throw Error("Lambert W pole")}var a=Math.exp(-1);if((0===r||-1===r)&&abs(add(e,a))<i*i)return isComplex(e)?complex(-1):-1;if(!isComplex(e)){if(0===r&&-a<e)return findRoot(r=>r*Math.exp(r)-e,[-1,1e3],{tolerance:i});if(-1===r&&-a<e&&e<0)return findRoot(r=>r*Math.exp(r)-e,[-1e3,-1],{tolerance:i});e=complex(e)}var t;t=0===r&&abs(e)<1.25?(0===e.im&&e.re<-a&&(e.im=i),e.re<.5?complex(0,.5*Math.sign(e.im)):complex(0)):sub(a=add(log(e),complex(0,2*pi*r)),log(a));for(var n=0;n<100;n++){var o=div(sub(mul(t,exp(t)),e),mul(exp(t),add(t,1)));if(t=sub(t,o),abs(o)<i)return t}throw Error("No Lambert W root found at "+JSON.stringify(e))}function inverseLambertW(r){return mul(r,exp(r))}function wrightOmega(r){return lambertW(Math.ceil((im(r)/pi-1)/2),exp(r))}function chop(r,e=1e-10){if(Array.isArray(r)){for(var i=vector(r.length),a=0;a<r.length;a++)i[a]=chop(r[a]);return i}return isComplex(r)?complex(chop(r.re),chop(r.im)):Math.abs(r)<e?0:r}function round(r,e){return 2===arguments.length?mul(e,round(div(r,e))):isComplex(r)?complex(Math.round(r.re),Math.round(r.im)):Math.round(r)}function ceiling(r){return isComplex(r)?complex(Math.ceil(r.re),Math.ceil(r.im)):Math.ceil(r)}function floor(r){return isComplex(r)?complex(Math.floor(r.re),Math.floor(r.im)):Math.floor(r)}function sign(r){return isZero(r)?r:div(r,abs(r))}function integerPart(r){return isComplex(r)?complex(Math.trunc(r.re),Math.trunc(r.im)):Math.trunc(r)}function fractionalPart(r){return sub(r,integerPart(r))}function random(r,e){return 0===arguments.length?Math.random():1===arguments.length?isComplex(r)?{re:r.re*Math.random(),im:r.im*Math.random()}:r*Math.random():isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),{re:random(r.re,e.re),im:random(r.im,e.im)}):Math.abs(r-e)*Math.random()+(e<r?e:r)}function kronecker(r,e){if(2===arguments.length)return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),isComplex(e)||(e=complex(e)),kronecker(r.re,e.re)*kronecker(r.im,e.im)):r===e?1:0;for(var i=kronecker(r,e),a=2;a<arguments.length;a++)i*=kronecker(r,arguments[a]);return i}function piecewise(){var a=arguments;return function(r){for(var e=0;e<a.length;e++){var i=a[e][1];if(r>=i[0]&&r<=i[1])return a[e][0](r)}return 0}}function hermite(r,e){function i(r){var e,i,a=[1],t=[2,0];if(0===r)return a;if(1===r)return t;for(var n=2;n<=r;n++){i=[],(e=t.slice()).push(0),a.unshift(0,0);for(var o=0;o<e.length;o++)i.push(2*e[o]-2*(n-1)*a[o]);a=t,t=i}return i}var a,t;return isComplex(r)||isComplex(e)?(isComplex(r)||(r=complex(r)),Number.isInteger(r.re)&&0<=r.re&&0===r.im?polynomial(e,i(r.re)):(a=div(r,-2),t=div(sub(1,r),2),t=sub(div(hypergeometric1F1(a,.5,pow(e,2)),gamma(t)),mul(2,e,div(hypergeometric1F1(t,1.5,pow(e,2)),gamma(a)))),mul(pow(2,r),sqrt(pi),t))):Number.isInteger(r)&&0<=r?polynomial(e,i(r)):(t=hypergeometric1F1(-r/2,.5,e**2)/gamma((1-r)/2)-2*e*hypergeometric1F1((1-r)/2,1.5,e**2)/gamma(-r/2),2**r*sqrt(pi)*t)}function laguerre(r,e,i){return arguments.length<3&&(i=e,e=0),mul(binomial(add(r,e),r),hypergeometric1F1(neg(r),add(e,1),i))}function chebyshevT(r,e){return cos(mul(r,arccos(e)))}function chebyshevU(r,e){return div(sin(mul(add(r,1),arccos(e))),sin(arccos(e)))}function legendreP(r,e,i,a=!1){if(arguments.length<3&&(i=e,e=0),Number.isInteger(r)&&Number.isInteger(e)&&Math.abs(i)<=1){var t=Math.abs(e);if(r<t)throw Error("Invalid spherical harmonic indices");if(!a){for(var n=1,o=r-e+1;o<=r+e;o++)n*=o;n=Math.sqrt(4*pi*n/(2*r+1))}var m=(-1)**t*Math.sqrt((2*t+1)/4/pi/factorial(2*t))*factorial2(2*t-1)*(1-i*i)**(t/2);if(t===r)return a?m:n*m;var s=t+1,l=(c=Math.sqrt(2*t+3))*i*m;if(s===r)return a?l:n*l;for(;s<r;){s++;var u=Math.sqrt((4*s*s-1)/(s*s-t*t)),p=u*(i*l-m/c),m=l,l=p,c=u}return a?p:n*p}return isPositiveInteger(e)?mul(pow(-1,e),inv(gamma(add(e,1))),gamma(add(r,e,1)),inv(gamma(add(r,neg(e),1))),pow(add(1,i),div(e,-2)),pow(sub(1,i),div(e,2)),hypergeometric2F1(neg(r),add(r,1),add(e,1),div(sub(1,i),2))):mul(inv(gamma(sub(1,e))),pow(add(1,i),div(e,2)),pow(sub(1,i),div(e,-2)),hypergeometric2F1(neg(r),add(r,1),sub(1,e),div(sub(1,i),2)))}function sphericalHarmonic(r,e,i,a){r=legendreP(r,e,cos(i),!0);return mul(Math.sign(e)**e,r,exp(complex(0,e*a)))}function legendreQ(e,r,i){function a(r){return sub(mul(cos(mul(pi,r)),legendreP(e,r,i)),mul(gamma(add(e,r,1)),inv(gamma(add(e,neg(r),1))),legendreP(e,neg(r),i)))}return arguments.length<3&&(i=r,r=0),isInteger(r)?mul(.5,pow(-1,r=!(1<abs(i))||isComplex(r)||1&r?r:complex(r)),diff(r=>a(r),r)):mul(pi/2,inv(sin(mul(pi,r))),a(r))}function doubleLambert(r,e,i,a=1e-10){if(2===arguments.length&&(i=e,e=r,r=0),isZero(i))return lambertW(r,e);if(isZero(e))return neg(lambertW(-r,neg(i)));function t(r,e,i){return add(log(sqrt(e)),neg(log(sqrt(neg(i)))),complex(0,r*pi))}m=.001,c=t(r=r,n=e,o=i);for(var n,o,m,s,l,u,p,c,d=abs(div(t(l=r,u=n,p=o),add(1,mul(2*(-1)**l,sqrt(u),sqrt(neg(p))))))<.9?c:(0===r&&console.log("Using Lambert W on principal branch"),l=1&r?0<r?(s=lambertW((r+1)/2,n,m),neg(lambertW(-(r+1)/2,neg(o),m))):(s=lambertW((r-1)/2,n,m),neg(lambertW(-(r-1)/2,neg(o),m))):(s=lambertW(r/2,n,m),neg(lambertW(-r/2,neg(o),m))),Math.abs(s.im-c.im)<Math.abs(l.im-c.im)?s:l),f=0;f<100;f++){var h=div(add(mul(e,exp(neg(d))),mul(i,exp(d)),neg(d)),add(mul(-1,e,exp(neg(d))),mul(i,exp(d)),-1)),d=sub(d,h);if(abs(h)<a)return d}throw Error("No double Lambert root found for x = "+JSON.stringify(e)+" and y = "+JSON.stringify(i))}function sin(r){if(isArbitrary(r)){if(isComplex(r))return{re:mul(sin(r.re),cosh(r.im)),im:mul(cos(r.re),sinh(r.im))};if(halfPi<(r%=twoPi))return sin(onePi-r);if(r<-halfPi)return sin(-onePi-r);for(var e=r,i=r,a=arb2;0n!==i;)e+=i=div(mul(i,-arb1,r,r),mul(a,a+arb1)),a+=arb2;return e}return isComplex(r)?{re:Math.sin(r.re)*Math.cosh(r.im),im:Math.cos(r.re)*Math.sinh(r.im)}:Math.sin(r)}function cos(r){if(isArbitrary(r)){if(isComplex(r))return{re:mul(cos(r.re),cosh(r.im)),im:-mul(sin(r.re),sinh(r.im))};if(halfPi<(r%=twoPi))return-cos(onePi-r);if(r<-halfPi)return-cos(-onePi-r);for(var e=arb1,i=arb1,a=arb1;0n!==i;)e+=i=div(mul(i,-arb1,r,r),mul(a,a+arb1)),a+=arb2;return e}return isComplex(r)?{re:Math.cos(r.re)*Math.cosh(r.im),im:-Math.sin(r.re)*Math.sinh(r.im)}:Math.cos(r)}function tan(r){return isComplex(r)?div(sin(r),cos(r)):Math.tan(r)}function cot(r){return isComplex(r)?div(cos(r),sin(r)):1/Math.tan(r)}function sec(r){return isComplex(r)?div(1,cos(r)):1/Math.cos(r)}function csc(r){return isComplex(r)?div(1,sin(r)):1/Math.sin(r)}function arcsin(r){var e;return isComplex(r)?(e=sqrt(sub(1,mul(r,r))),e=add(mul(complex(0,1),r),e),mul(complex(0,-1),log(e))):Math.abs(r)<=1?Math.asin(r):arcsin(complex(r))}function arccos(r){return isComplex(r)?sub(pi/2,arcsin(r)):Math.abs(r)<=1?Math.acos(r):arccos(complex(r))}function arctan(r){var e;return isComplex(r)?(e=sub(log(sub(1,mul(complex(0,1),r))),log(add(1,mul(complex(0,1),r)))),mul(complex(0,.5),e)):Math.atan(r)}function arccot(r){return isComplex(r)?arctan(div(1,r)):Math.atan(1/r)}function arcsec(r){return isComplex(r)?arccos(div(1,r)):1<=Math.abs(r)?Math.acos(1/r):arcsec(complex(r))}function arccsc(r){return isComplex(r)?arcsin(div(1,r)):1<=Math.abs(r)?Math.asin(1/r):arccsc(complex(r))}function sinh(r){return isArbitrary(r)?div(sub(exp(r),exp(neg(r))),arb2):isComplex(r)?{re:Math.sinh(r.re)*Math.cos(r.im),im:Math.cosh(r.re)*Math.sin(r.im)}:Math.sinh(r)}function cosh(r){return isArbitrary(r)?div(add(exp(r),exp(neg(r))),arb2):isComplex(r)?{re:Math.cosh(r.re)*Math.cos(r.im),im:Math.sinh(r.re)*Math.sin(r.im)}:Math.cosh(r)}function tanh(r){return isComplex(r)?div(sinh(r),cosh(r)):Math.tanh(r)}function coth(r){return isComplex(r)?div(cosh(r),sinh(r)):1/Math.tanh(r)}function sech(r){return isComplex(r)?div(1,cosh(r)):1/Math.cosh(r)}function csch(r){return isComplex(r)?div(1,sinh(r)):1/Math.sinh(r)}function arcsinh(r){var e;return isComplex(r)?(e=sqrt(add(mul(r,r),1)),log(e=add(r,e))):Math.asinh(r)}function arccosh(r){var e;return isComplex(r)?(e=mul(sqrt(add(r,1)),sqrt(sub(r,1))),log(e=add(r,e))):1<=r?Math.acosh(r):arccosh(complex(r))}function arctanh(r){return isComplex(r)?mul(.5,sub(log(add(1,r)),log(sub(1,r)))):Math.abs(r)<=1?Math.atanh(r):arctanh(complex(r))}function arccoth(r){if(isComplex(r)){if(0===r.re&&0===r.im)throw Error("Indeterminate arccoth value");return arctanh(div(1,r))}return 1<Math.abs(r)?Math.atanh(1/r):arccoth(complex(r))}function arcsech(r){if(isComplex(r)){if(0===r.re&&0===r.im)throw Error("Indeterminate arcsech value");return 0===r.im&&(r.im=-Number.MIN_VALUE),arccosh(div(1,r))}return 0<r&&r<1?Math.acosh(1/r):arcsech(complex(r))}function arccsch(r){return isComplex(r)?arcsinh(div(1,r)):Math.asinh(1/r)}function sinc(r){return isComplex(r)?0===r.re&&0===r.im?complex(1):div(sin(r),r):0===r?1:Math.sin(r)/r}function haversine(r){return div(sub(1,cos(r)),2)}function inverseHaversine(r){return arccos(sub(1,mul(2,r)))}function gudermannian(r){return mul(2,arctan(tanh(div(r,2))))}function inverseGudermannian(r){return mul(2,arctanh(tan(div(r,2))))}function zeta(e,r=1e-10){if(isUnity(e))throw Error("Riemann zeta pole");if(e<0||e.re<0)return mul(pow(2,e),pow(pi,sub(e,1)),sin(mul(pi/2,e)),gamma(sub(1,e)),zeta(sub(1,e)));if(5<e||5<e.re){if(isComplex(e))for(var i=complex(1),a=complex(1),t=2;Math.abs(a.re)>r||Math.abs(a.im)>r*r;)i=add(i,a=pow(t,neg(e))),t++;else for(i=1,a=1,t=2;Math.abs(a)>r;)i+=a=1/t**e,t++;return i}for(var n=14,o=(isComplex(e)&&0!==e.im&&(n=Math.max(n,Math.ceil(log(2/abs(gamma(e))/r)/log(3+sqrt(8))))),[1]),m=n,t=1;t<=n;t++)o.push(o[t-1]+n*m/factorial(2*t)*4**t),m*=(n+t)*(n-t);return isComplex(e)?(i=summation(r=>div((-1)**r*(o[r]-o[n]),pow(r+1,e)),[0,n-1]),div(div(i,-o[n]),sub(1,pow(2,sub(1,e))))):-(i=summation(r=>(-1)**r*(o[r]-o[n])/(r+1)**e,[0,n-1]))/o[n]/(1-2**(1-e))}function dirichletEta(r){return mul(zeta(r),sub(1,pow(2,sub(1,r))))}function riemannXi(r){var e;return isZero(r)||isUnity(r)?isComplex(r)?complex(.5):.5:mul(e=div(r,2),sub(r,1),pow(pi,neg(e)),gamma(e),zeta(r))}function bernoulli(e,r){return 2===arguments.length?isZero(e)?isComplex(e)||isComplex(r)?complex(1):1:isNegativeIntegerOrZero(r)?complexAverage(r=>bernoulli(e,r),r):mul(neg(e),hurwitzZeta(sub(1,e),r)):Number.isInteger(e)&&0<=e?0===e?1:1===e?-.5:1&e?0:(r=e/2)<=bernoulli2nN.length?arbitrary(div(bernoulli2nN[r],bernoulli2nD[r])):-e*zeta(1-e):isPositiveIntegerOrZero(e)?complex(bernoulli(e.re)):(console.log("Returning generalized Bernoulli number"),bernoulli(e,0))}function harmonic(r){if(Number.isInteger(r))return 1e3<r?log(r)+eulerGamma+.5/r-1/12/r**2:summation(r=>1/r,[1,r]);throw Error("Noninteger index for harmonic number")}function hurwitzZeta(e,i,r=1e-10){if(isUnity(e))throw Error("Hurwitz zeta pole");if(isNegativeIntegerOrZero(i))throw Error("Hurwitz zeta parameter pole");if(isComplex(e)||isComplex(i)){if(isComplex(e)||(e=complex(e)),(i=isComplex(i)?i:complex(i)).re<0)return d=-Math.floor(i.re),add(hurwitzZeta(e,add(i,d)),summation(r=>pow(add(i,r),neg(e)),[0,d-1]));var a=15;if(e.re<0){setPrecisionScale(20-Math.round(e.re)),e=arbitrary(e),i=arbitrary(i);for(var t=arbitrary(a),n=arbitrary(3),o=0n,m=0;m<a;m++)o=add(o,pow(div(add(i,t),add(i,arbitrary(m))),e));for(var s=div(add(i,t),sub(e,arb1)),l=div(mul(arb1/2n,e),add(i,t)),u=mul(div(bernoulli2nN[1],bernoulli2nD[1]),l),m=arb2,p=2;(0n!==l.re||0n!==l.im)&&p!==bernoulli2nN.length;)l=div(mul(l,add(e,2n*m-arb2),add(e,2n*m-n)),mul(2n*m,2n*m-arb1,add(i,t),add(i,t))),u=add(u,mul(div(bernoulli2nN[p],bernoulli2nD[p]),l)),m+=arb1,p++;var c=add(arb1/2n,u),d=arbitrary(mul(add(o,s,c),pow(add(i,t),mul(-arb1,e))));return resetPrecisionScale(),d}for(o=summation(r=>pow(add(i,r),neg(e)),[0,a-1]),s=div(pow(add(i,a),sub(1,e)),sub(e,1)),l=mul(.5,e,inv(add(i,a))),u=mul(bernoulli(2),l),m=2;Math.abs(l.re)>r||Math.abs(l.im)>r;)l=div(mul(l,add(e,2*m-2),add(e,2*m-3)),mul(2*m*(2*m-1),add(i,a),add(i,a))),u=add(u,mul(bernoulli(2*m),l)),m++;c=div(add(.5,u),pow(add(i,a),e));return add(o,s,c)}if(i<0)return hurwitzZeta(e,complex(i));if(e<-5){e=1-e;for(var f=u=Math.cos(pi*e/2-2*pi*i),m=1;Math.abs(u)>r;)m++,f+=u=Math.cos(pi*e/2-2*m*pi*i)/m**e;return 2*gamma(e)/(2*pi)**e*f}for(o=summation(r=>1/(i+r)**e,[0,(a=15)-1]),s=(i+a)**(1-e)/(e-1),l=e/2/(i+a),u=bernoulli(2)*l,m=2;Math.abs(l)>r;)l*=(e+2*m-2)*(e+2*m-3)/(2*m*(2*m-1)*(i+a)**2),u+=bernoulli(2*m)*l,m++;return o+s+(c=(.5+u)/(i+a)**e)}function polylog(r,e,i=1e-10){if(isEqualTo(e,1))return zeta(r);if(isEqualTo(e,-1))return neg(dirichletEta(r));if(isEqualTo(r,1))return neg(log(sub(1,e)));if(isEqualTo(r,0))return div(e,sub(1,e));if(isEqualTo(r,-1))return div(e,mul(sub(1,e),sub(1,e)));var a,t,n,o;if(1<abs(e))return t=complex(0,2*pi),isPositiveInteger(r)?(a=neg(add(mul((-1)**r,polylog(r,inv(e))),mul(div(pow(t,r),factorial(r)),bernoulli(r,div(log(e),t))),(a=isComplex(e)?e:complex(e)).im<0||0===a.im&&1<=a.re?mul(t,div(pow(log(e),r-1),factorial(r-1))):0)),!isComplex(e)&&e<0?a.re:a):(a=sub(1,r),o=complex(0,1),t=div(log(neg(e)),t),n=mul(pow(o,a),hurwitzZeta(a,add(.5,t))),o=mul(pow(o,neg(a)),hurwitzZeta(a,sub(.5,t))),mul(gamma(a),pow(2*pi,neg(a)),add(n,o)));if(isComplex(r)||isComplex(e))for(var m=e,s=complex(1),l=2;Math.abs(s.re)>i||Math.abs(s.im)>i;)m=add(m,s=div(pow(e,l),pow(l,r))),l++;else for(m=e,s=1,l=2;Math.abs(s)>i;)m+=s=e**l/l**r,l++;return m}function ode(r,e,[i,a],t=.001,n="runge-kutta"){var o,m;if(a<i?(o=r=>a<=r,t*=-1):o=r=>r<=a,Array.isArray(e)||(m=r,r=(r,e)=>[m(r,e)],e=[e]),isComplex(i)||isComplex(a)||e.some(r=>isComplex(r))||r(i,e).some(r=>isComplex(r))){if(isComplex(i)||(i=complex(i)),e.forEach((r,e,i)=>{isComplex(r)||(i[e]=complex(r))}),r(i,e).every(r=>!isComplex(r)))throw Error("All functions must handle complex math");var s=sub(a,i),l=abs(s),u=(t=mul(t,div(s,l)),Math.trunc(l/abs(t))),p=0}var c=[[i].concat(e)],d=e.length;switch(n){case"euler":if(isComplex(i))for(var f=add(i,t);p<u;f=add(f,t)){for(var h=r(f,e),b=0;b<d;b++)e[b]=add(e[b],mul(h[b],t));c.push([f].concat(e)),p++}else for(f=i+t;o(f);f+=t){for(h=r(f,e),b=0;b<d;b++)e[b]+=h[b]*t;c.push([f].concat(e))}return c;case"runge-kutta":if(isComplex(i))for(var g=div(t,2),f=add(i,t);p<u;f=add(f,t)){for(var v=[],x=[],M=[],C=r(f,e),b=0;b<d;b++)v.push(add(e[b],mul(C[b],g)));for(var w=r(add(f,g),v),b=0;b<d;b++)x.push(add(e[b],mul(w[b],g)));for(var y=r(add(f,g),x),b=0;b<d;b++)M.push(add(e[b],mul(y[b],t)));for(var I=r(add(f,t),M),b=0;b<d;b++)e[b]=add(e[b],mul(add(C[b],mul(2,w[b]),mul(2,y[b]),I[b]),t,1/6));c.push([f].concat(e)),p++}else for(f=i+t;o(f);f+=t){for(v=[],x=[],M=[],C=r(f,e),b=0;b<d;b++)v.push(e[b]+C[b]*t/2);for(w=r(f+t/2,v),b=0;b<d;b++)x.push(e[b]+w[b]*t/2);for(y=r(f+t/2,x),b=0;b<d;b++)M.push(e[b]+y[b]*t);for(I=r(f+t,M),b=0;b<d;b++)e[b]+=(C[b]+2*w[b]+2*y[b]+I[b])*t/6;c.push([f].concat(e))}return c;default:throw Error("Unsupported differential equation solver method")}}function diff(i,a,t=1,r="ridders"){if(!isPositiveInteger(t))throw Error("Only positive integer orders for differentiation");if(isComplex(a)||isComplex(i(a))){var e,n;if(isComplex(i(a)))return e=abs(a),n=0===e?complex(1):div(a,e),div(complex(diff(r=>i(mul(n,r)).re,e,t,r),diff(r=>i(mul(n,r)).im,e,t,r)),n);throw Error("Function must handle complex math")}function o(){for(var r=0,e=0;e<=t;e++)r+=(-1)**e*binomial(t,e)*i(a+(t-2*e)*m);return r/(2*m)**t}switch(r){case"naive":var m=1e-8**(1/(t+2));return o();case"ridders":for(var s,m=1e-5**(1/(t+2)),l=Number.MAX_VALUE,u=[],p=0;p<10;p++)u.push([]);u[0][0]=o();for(p=1;p<10;p++){m/=2,u[0][p]=o();for(var c=1;c<=p;c++){u[c][p]=(4**c*u[c-1][p]-u[c-1][p-1])/(4**c-1);var d=Math.max(Math.abs(u[c][p]-u[c-1][p]),Math.abs(u[c][p]-u[c-1][p-1]));d<=l&&(l=d,s=u[c][p])}if(Math.abs(u[p][p]-u[p-1][p-1])>l)break}return s;default:throw Error("Unsupported differentiation method")}}var D=diff;function taylorSeries(r,a,e=5){for(var t=[r(a)],i=1;i<e;i++)t.push(diff(r,a,i));return function(r){for(var e=0,i=0;i<t.length;i++)e=add(e,mul(t[i],pow(sub(r,a),i),1/factorial(i)));return e}}function gradient(e,r){if(e.length!==r.length)throw Error("Gradient point length differs from function");for(var i=[],a=0;a<r.length;a++){var t=r.slice();i.push(diff(r=>(t[a]=r,e.apply(null,t)),t[a]))}return i}function findExtremum(r,e,i={}){Array.isArray(e)||(e=[e]);for(var a,t=i.findMaximum?1:-1,n=("tolerance"in i?i.tolerance:1e-10),o=.01*t,m=0;m<1e4;m++){for(var s=gradient(r,e),l=!0,u=0;u<e.length;u++)a=o*s[u],e[u]+=a,l=l&&a<n;if(l)return 1===e.length?e[0]:e}throw Error("No extremum found for tolerance "+n)}function integrate(h,[e,i],r={}){var a,t,S="method"in r?r.method:"adaptive-simpson",n="tolerance"in r?r.tolerance:1e-10;if(isComplex(e)||isComplex(i)||isComplex(h(e))){if(isComplex(e)||(e=complex(e)),isComplex(i)||(i=complex(i)),e.re===i.re&&e.im===i.im)return complex(0);if(isComplex(h(e)))return a=integrate(r=>h(o(r)).re,[0,1],r),t=integrate(r=>h(o(r)).im,[0,1],r),mul(sub(i,e),complex(a,t));throw Error("Function must handle complex math");function o(r){return add(mul(sub(i,e),r),e)}}if(e===i)return 0;function m(){for(var r=e+(s/=2);r<i;)l+=h(r),r+=2*s}switch(r.avoidEndpoints&&(e<i?(e+=n,i-=n):(e-=n,i+=n)),S){case"euler-maclaurin":for(var b=50,s=(i-e)/2,l=(h(e)+h(i))/2+h((e+i)/2),u=d=s*l,p=0;p<b;p++){if(m(),d=s*l,Math.abs(d-u)<n*Math.abs(u))return d;u=d}throw Error("Maximum interations reached");case"romberg":for(var c=Number.MAX_VALUE,b=30,s=(i-e)/2,l=(h(e)+h(i))/2+h((e+i)/2),d=s*l,f=[],p=0;p<b;p++)f.push([]);f[0][0]=d;for(p=1;p<b;p++){m(),f[0][p]=s*l;for(var g=1;g<=p;g++)f[g][p]=(4**g*f[g-1][p]-f[g-1][p-1])/(4**g-1),(R=Math.max(Math.abs(f[g][p]-f[g-1][p]),Math.abs(f[g][p]-f[g-1][p-1])))<=c&&(c=R,d=f[g][p]);if(Math.abs(f[p][p]-f[p-1][p-1])>c)break}return d;case"adaptive-simpson":b=50;var v=h(e),x=h((e+i)/2),M=h(e);return function r(e,i,a,t,n,o,m,s){var l=i-e,u=h(e+l/4),p=h(i-l/4);if(isNaN(u)||isNaN(p))throw Error("NaN encountered in integration");var c=(a+4*u+t)*l/12,d=(t+4*p+n)*l/12,f=c+d,o=(f-o)/15;return Math.abs(o)<m||b<s?f+o:r(e,f=e+l/2,a,u,t,c,m/2,s+1)+r(f,i,t,p,n,d,m/2,s+1)}(e,i,v,x,M,l=(v+4*x+M)*(i-e)/6,n,0);case"tanh-sinh":for(var s=1/2**(P=10),C=[],w=[],y=0;y<=20*2**P;y++){var I=y*s;if(C[y]=Math.tanh(Math.PI/2*Math.sinh(I)),w[y]=Math.PI/2*Math.cosh(I)/Math.cosh(Math.PI/2*Math.sinh(I))**2,Math.abs(1-C[y])<n)break}for(var U=y,A=0,q=(i-e)/2,E=(i+e)/2,y=1;y<=P;y++)for(p=0;p<U;p+=2**(P-y))p%2**(P-y+1)==0&&1!==y||(A+=0===p?w[0]*h(E):w[p]*(h(E-q*C[p])+h(E+q*C[p])));return q*s*A;case"gaussian":for(var P,C=[],w=[],N=3*2**(P=10),g=1;g<=N/2;g++){for(var F=Math.cos(Math.PI*(g-.25)/(.5+N));;){for(var Z=1,T=0,j=1;j<=N;j++)t3=T,Z=((2*j-1)*F*(T=Z)-(j-1)*t3)/j;var R,J=N*(F*Z-T)/(F**2-1);if(F-=R=Z/J,Math.abs(R)<n)break}C[g]=F,w[g]=2/(1-F**2)/J**2}for(q=(i-e)/2,E=(i+e)/2,A=0,g=1;g<=N/2;g++)A+=w[g]*(h(E-q*C[g])+h(E+q*C[g]));return q*A;default:throw Error("Unsupported integration method")}}function discreteIntegral(r,e){for(var i=(r[0]+r[r.length-1])/2,a=1;a<r.length-1;a++)i+=r[a];return i*e}function summation(r,[e,i,a=1]){if(isComplex(r(e)))for(var t=complex(0),n=e;n<=i;n+=a)t=add(t,r(n));else for(t=0,n=e;n<=i;n+=a)t+=r(n);return t}function polynomial(r,e,i={}){for(var a=("derivative"in i&&i.derivative),t=((e="reverse"in i&&i.reverse?e.slice().reverse():e)[0]),n=0,o=1;o<e.length;o++)a&&(n=add(t,mul(n,r))),t=add(e[o],mul(t,r));return a?{polynomial:t,derivative:n}:t}function partialBell(r,e,i){if(0===r&&0===e)return 1;if(0===r||0===e)return 0;for(var a=0,t=1,n=1;n<=r-e+1;n++)a+=t*i[n-1]*partialBell(r-n,e-1,i),t*=(r-n)/n;return a}function findRoot(r,e,i={}){var a="tolerance"in i?i.tolerance:1e-10;if(Array.isArray(r)){if(r.length!==e.length)throw Error("Mismatch between equations and starting point for root");for(var t=e.slice(),n=0;n<100;n++){for(var o=[],m=[],s=0;s<t.length;s++)o.push(gradient(r[s],t)),m.push(r[s].apply(null,t));for(var l=luSolve(o,m),s=0;s<t.length;s++)t[s]-=l[s];if(l.every(r=>Math.abs(r)<a))return t}throw Error("No root found for tolerance "+a)}switch(Array.isArray(e)||i.method||(i.method="newton"),"method"in i?i.method:"bisect"){case"bisect":var u=e[0],p=e[1],c=r(u);r(p);if(0<=c*r(p))throw Error("Change of sign necessary for bisection");for(var d=c<0?p-(t=u):u-(t=p),n=0;n<100;n++){var f=t+(d/=2);if((fmid=r(f))<=0&&(t=f),0===fmid||Math.abs(d)<a)return t}throw Error("No root found for tolerance "+a);case"newton":if(isComplex(r(t=e))){for(n=0;n<100;n++)if(t=sub(t,l=div(r(t),diff(r,t))),abs(l)<a)return t}else for(n=0;n<100;n++)if(t-=l=r(t)/diff(r,t),Math.abs(l)<a)return t;throw Error("No root found for tolerance "+a);default:throw Error("Unsupported root finding method")}}function findRoots(r,e,i=0){console.log("Renamed to findRoot")}function spline(t,r="function",a=1e-10){for(var n=[],o=[],m=[],s=[],e=0;e<t.length;e++)n[e]=t[e][1];m[0]=0,m[t.length-1]=0;var i=matrix(t.length-2),l=vector(t.length-2);function u(r){return t[r+1][0]-t[r][0]}for(e=0;e<i.length;e++)i[e][e]=2*(u(e)+u(e+1)),l[e]=3*(n[e+2]-n[e+1])/u(e+1)-3*(n[e+1]-n[e])/u(e);for(e=1;e<i.length;e++)i[e][e-1]=u(e),i[e-1][e]=u(e);for(var p=luSolve(i,l),e=0;e<p.length;e++)m[e+1]=p[e];for(e=0;e<m.length-1;e++)o[e]=(n[e+1]-n[e])/u(e)-(m[e+1]+2*m[e])*u(e)/3,s[e]=(m[e+1]-m[e])/3/u(e);switch(r){case"function":return function(r){if(r<t[0][0]||r>t[t.length-1][0])throw Error("Argument outside spline input domain");for(var e=0;e<t.length;e++)if(r===t[e][0])return n[e];for(var i,e=0;e<t.length-1;e++)if(r>t[e][0]&&r<t[e+1][0])return i=t[e][0],n[e]+o[e]*(r-i)+m[e]*(r-i)**2+s[e]*(r-i)**3};case"derivative":return function(r){if(r<t[0][0]||r>t[t.length-1][0])throw Error("Argument outside spline input domain");r===t[t.length-1][0]&&(r-=a);for(var e=0;e<t.length;e++)if(r===t[e][0])return o[e];for(var i,e=0;e<t.length-1;e++)if(r>t[e][0]&&r<t[e+1][0])return i=t[e][0],o[e]+2*m[e]*(r-i)+3*s[e]*(r-i)**2};case"integral":return function(r){if(r<t[0][0]||r>t[t.length-1][0])throw Error("Argument outside spline input domain");var e=0;function i(r,e){var i=t[e][0];return n[e]*(r-i)+o[e]*(r-i)**2/2+m[e]*(r-i)**3/3+s[e]*(r-i)**4/4}for(var a=0;a<t.length-1;a++){if(r<t[a+1][0]){e+=i(r,a)-i(t[a][0],a);break}e+=i(t[a+1][0],a)-i(t[a][0],a)}return e};default:throw Error("Unsupported spline value")}}function padeApproximant(r,e,i,a=0){if(!isPositiveInteger(e)||!isPositiveInteger(i))throw Error("Pade indices must be positive integers");var t=[];if("function"==typeof r){t.push(r(a));for(var n=1;n<=e+i;n++)t.push(diff(r,a,n)/factorial(n))}else{if(r.length<e+i+1)throw Error("Need n+d+1 Pade coefficients");t=r}for(var o=matrix(i),m=vector(i),n=0;n<i;n++){m[n]=-t[e+1+n];for(var s=0;s<i&&s<=e+n;s++)o[n][s]=t[e+n-s]}try{var l=luSolve(o,m)}catch{throw Error("Singular Pade matrix encountered")}l.unshift(1);for(var u=[t[0]],n=1;n<=e;n++){for(var p=t[n],s=1;s<=i&&s<=n;s++)p+=l[s]*t[n-s];u.push(p)}return{N:chop(u),D:chop(l)}}function fourierSinCoefficient(e,i,r){if(!Number.isInteger(i))throw Error("Nonintegral Fourier index");if(0===i)return 0;var a;if("function"==typeof e)return 2/(a=r||2*pi)*integrate(r=>e(r)*sin(2*i*pi/a*r),[0,a],{method:"tanh-sinh"});if(Array.isArray(e)){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o][1]*sin(2*i*pi*o/n);return 2*t/n}throw Error("Unsupported Fourier input")}function fourierCosCoefficient(e,i,r){if(!Number.isInteger(i))throw Error("Nonintegral Fourier index");var a;if("function"==typeof e)return a=r||2*pi,0===i?1/a*integrate(r=>e(r),[0,a],{method:"tanh-sinh"}):2/a*integrate(r=>e(r)*cos(2*i*pi/a*r),[0,a],{method:"tanh-sinh"});if(Array.isArray(e)){var t=0,n=e.length;if(0===i){for(var o=0;o<n;o++)t+=e[o][1];return t/n}for(o=0;o<n;o++)t+=e[o][1]*cos(2*i*pi*o/n);return 2*t/n}throw Error("Unsupported Fourier input")}function eigensystem(r,e=!0){if(e)return tridiagonalQL(tridiagonalForm(r));throw Error("Unsupported eigensystem")}function tridiagonalForm(r){for(var e=r.length,i=[],a=0;a<e;a++)i[a]=r[a].slice();for(var t=vector(e),n=vector(e),o=0;o<e;o++)t[o]=i[e-1][o];for(a=e-1;0<a;a--){for(var m=0,s=0,l=0;l<a;l++)m+=Math.abs(t[l]);if(0===m){n[a]=t[a-1];for(o=0;o<a;o++)t[o]=i[a-1][o],i[a][o]=0,i[o][a]=0}else{for(l=0;l<a;l++)t[l]/=m,s+=t[l]*t[l];var u=t[a-1],p=Math.sqrt(s);n[a]=m*(p=0<u?-p:p),s-=u*p,t[a-1]=u-p;for(o=0;o<a;o++)n[o]=0;for(o=0;o<a;o++){u=t[o],i[o][a]=u,p=n[o]+i[o][o]*u;for(l=o+1;l<=a-1;l++)p+=i[l][o]*t[l],n[l]+=i[l][o]*u;n[o]=p}for(u=0,o=0;o<a;o++)n[o]/=s,u+=n[o]*t[o];for(var c=u/(s+s),o=0;o<a;o++)n[o]-=c*t[o];for(o=0;o<a;o++){u=t[o],p=n[o];for(l=o;l<=a-1;l++)i[l][o]-=u*n[l]+p*t[l];t[o]=i[a-1][o],i[a][o]=0}}t[a]=s}for(a=0;a<e-1;a++){if(i[e-1][a]=i[a][a],0!==(s=t[a+(i[a][a]=1)])){for(l=0;l<=a;l++)t[l]=i[l][a+1]/s;for(o=0;o<=a;o++){for(p=0,l=0;l<=a;l++)p+=i[l][a+1]*i[l][o];for(l=0;l<=a;l++)i[l][o]-=p*t[l]}}for(l=0;l<=a;l++)i[l][a+1]=0}for(o=0;o<e;o++)t[o]=i[e-1][o],i[e-1][o]=0;return i[e-1][e-1]=1,n[0]=0,{diagonal:t,offDiagonal:n,eigenvectors:i}}function tridiagonalQL(r){var e=r.diagonal,i=e.length,a=r.offDiagonal,t=r.eigenvectors;function n(r,e){var i=Math.abs(r)>Math.abs(e)?(i=e/r,Math.abs(r)*Math.sqrt(1+i*i)):0!=e?(i=r/e,Math.abs(e)*Math.sqrt(1+i*i)):0;return i}for(var o=1;o<i;o++)a[o-1]=a[o];for(var m=a[i-1]=0,s=0,l=Math.pow(2,-52),u=0;u<i;u++){for(var s=Math.max(s,Math.abs(e[u])+Math.abs(a[u])),p=u;p<i&&!(Math.abs(a[p])<=l*s);)p++;if(u<p){var c=0;do{if(1e3<(c+=1))throw Error("Eigenvalues not converging...");for(var d=e[u],f=n(I=(e[u+1]-d)/(2*a[u]),1),h=(e[u]=a[u]/(I+(f=I<0?-f:f)),e[u+1]=a[u]*(I+f),e[u+1]),b=d-e[u],o=u+2;o<i;o++)e[o]-=b;m+=b,I=e[p];for(var g=1,v=g,x=g,M=a[u+1],C=0,w=0,o=p-1;u<=o;o--){x=v,w=C,d=(v=g)*a[o],b=g*I,f=n(I,a[o]),a[o+1]=C*f,C=a[o]/f,I=(g=I/f)*e[o]-C*d,e[o+1]=b+C*(g*d+C*e[o]);for(var y=0;y<i;y++)b=t[y][o+1],t[y][o+1]=C*t[y][o]+g*b,t[y][o]=g*t[y][o]-C*b}}while(I=-C*w*x*M*a[u]/h,a[u]=C*I,e[u]=g*I,Math.abs(a[u])>l*s)}e[u]=e[u]+m,a[u]=0}for(o=0;o<i-1;o++){for(var y=o,I=e[o],A=o+1;A<i;A++)e[A]<I&&(I=e[y=A]);if(y!=o){e[y]=e[o],e[o]=I;for(A=0;A<i;A++)I=t[A][o],t[A][o]=t[A][y],t[A][y]=I}}return{eigenvalues:e,eigenvectors:t}}function hessenbergForm(r){}function luDecomposition(r,e=1e-10){for(var i=r.length,a=[],t=0;t<i;t++)a[t]=r[t].slice();for(var n=identity(i),t=pivots=0;t<i;t++){for(var o,m=0,s=t,l=t;l<i;l++){var u=Math.abs(a[l][t]);m<u&&(m=u,s=l)}if(m<e)throw Error("Matrix is degenerate");s!==t&&(o=a[t],a[t]=a[s],a[s]=o,o=n[t],n[t]=n[s],n[s]=o,pivots++);for(l=t+1;l<i;l++){a[l][t]/=a[t][t];for(var p=t+1;p<i;p++)a[l][p]-=a[l][t]*a[t][p]}}for(var c=identity(i),t=1;t<i;t++)for(l=0;l<t;l++)c[t][l]=a[t][l];for(var d=matrix(i),t=0;t<i;t++)for(l=t;l<i;l++)d[t][l]=a[t][l];return{L:c,U:d,P:n,pivots:pivots}}function luSolve(r,e){for(var i=r.length,a=luDecomposition(r),t=vector(i),n=vector(i),o=vector(i),m=0;m<i;m++)for(var s=0;s<i;s++)o[m]+=a.P[m][s]*e[s];for(m=0;m<i;m++){n[m]=o[m];for(s=0;s<m;s++)n[m]-=a.L[m][s]*n[s];n[m]/=a.L[m][m]}for(m=i-1;0<=m;m--){t[m]=n[m];for(s=m+1;s<i;s++)t[m]-=a.U[m][s]*t[s];t[m]/=a.U[m][m]}return t}function determinant(r){for(var e=luDecomposition(r),i=1,a=0;a<r.length;a++)i*=e.U[a][a];return(-1)**e.pivots*i}function inverse(r){for(var e=matrix(r.length),i=0;i<r.length;i++)for(var a=vector(r.length),t=(a[i]=1,luSolve(r,a)),n=0;n<r.length;n++)e[n][i]=t[n];return e}function vector(r,e=0){for(var i=[],a=0;a<r;a++)Array.isArray(e)?i.push(random.apply(null,e)):i.push(e);return i}function matrix(r,e,i=0){for(var e=e||r,a=[],t=0;t<r;t++){a.push([]);for(var n=0;n<e;n++)Array.isArray(i)?a[t].push(random.apply(null,i)):a[t].push(i)}return a}function identity(r,e=1){for(var i=matrix(r),a=0;a<r;a++)i[a][a]=e;return i}function transpose(r){for(var e=matrix(r[0].length,r.length),i=0;i<r.length;i++)for(var a=0;a<r[0].length;a++)e[a][i]=r[i][a];return e}function matrixAdd(r,e){if(!Array.isArray(r)&&!Array.isArray(e))throw Error("No matrices to add");Array.isArray(r)||(r=matrix(e.length,e[0].length,r)),Array.isArray(e)||(e=matrix(r.length,r[0].length,e));for(var i=matrix(r.length,r[0].length,0),a=0;a<r.length;a++)for(var t=0;t<r[0].length;t++)i[a][t]=add(r[a][t],e[a][t]);return i}function matrixSub(r,e){if(!Array.isArray(r)&&!Array.isArray(e))throw Error("No matrices to subtract");Array.isArray(r)||(r=matrix(e.length,e[0].length,r)),Array.isArray(e)||(e=matrix(r.length,r[0].length,e));for(var i=matrix(r.length,r[0].length,0),a=0;a<r.length;a++)for(var t=0;t<r[0].length;t++)i[a][t]=sub(r[a][t],e[a][t]);return i}function matrixMul(r,e){if(!Array.isArray(r)&&!Array.isArray(e))throw Error("No matrices to multiply");if(Array.isArray(r)||(r=identity(e.length,r)),Array.isArray(e)||(e=identity(r[0].length,e)),r[0].length!==e.length)throw Error("Incompatible matrices to multiply");for(var i=matrix(r.length,e[0].length,0),a=0;a<r.length;a++)for(var t=0;t<e[0].length;t++)for(var n=0;n<r[0].length;n++)i[a][t]=add(i[a][t],mul(r[a][n],e[n][t]));return i}